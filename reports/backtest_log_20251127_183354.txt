================================================================================
                    INTRADAY MOMENTUM OI UNWINDING STRATEGY
                              Backtest Runner
================================================================================

Loading configuration...
Configuration loaded from: config/strategy_config.yaml

Preparing data...
Loading spot price data...
Loaded 5625 spot price records from 2025-01-01 09:15:00 to 2025-01-21 15:29:00
Loading options data (this may take a while for large files)...
Loaded 1206944 options records
Filtered to 773758 weekly expiry option records

Data Summary:
  Spot data: 5625 bars from 2025-01-01 09:15:00 to 2025-01-21 15:29:00
  Options data: 773758 records
  Timeframe: 1 minute(s)

Initializing OI Analyzer...
Setting up Backtrader...
Initial Portfolio Value: ‚Çπ100,000.00

================================================================================
Running backtest...
================================================================================

Strategy initialized
[2025-01-01 09:15:00] Starting daily analysis - Spot: 23649.55
[2025-01-01 09:15:00] Found expiry: 2025-01-02
[2025-01-01 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-01 09:15:00] Max Call OI: 23800, Max Put OI: 23500
[2025-01-01 09:15:00] Direction determined: PUT (Call dist: 150.45, Put dist: 149.55)
[2025-01-01 09:15:00] ‚úì Daily Analysis Complete: Direction=PUT, Strike=23600, Expiry=2025-01-02, Spot=23649.55
[2025-01-01 09:30:00] Checking entry: PE 23600, Expiry=2025-01-02
[2025-01-01 09:30:00] PE 23600: OI=7673325, Change=0 (0.00%) - BUILDING
[2025-01-01 09:36:00] üéØ ENTRY SIGNAL: PE 23600 - Price: 103.50, VWAP: 97.47, OI Change: -186975 (-2.41%)
[2025-01-01 09:36:00] üìà PLACING BUY ORDER: size=1, expected_price=103.50
[2025-01-01 09:37:00] üîµ BUY OPTION EXECUTED: PE 23600 @ ‚Çπ103.40 (Expiry: 2025-01-02, Lot size: 1)
[2025-01-01 10:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 10:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 11:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 11:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 12:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 12:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 13:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 13:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 14:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 14:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 14:50:00] END OF DAY - Closing all positions (size=1)
[2025-01-01 14:51:00] üî¥ SELL OPTION EXECUTED: PE 23600 @ ‚Çπ52.25 | Entry: ‚Çπ103.40 | P&L: ‚Çπ51.15 (-49.47%)
[2025-01-01 14:51:00] TRADE PROFIT: Gross 135.40, Net 111.71
[2025-01-02 09:15:00] Starting daily analysis - Spot: 23787.60
[2025-01-02 09:15:00] Found expiry: 2025-01-09
[2025-01-02 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-02 09:15:00] Max Call OI: 23800, Max Put OI: 23700
[2025-01-02 09:15:00] Direction determined: CALL (Call dist: 12.40, Put dist: 87.60)
[2025-01-02 09:15:00] ‚úì Daily Analysis Complete: Direction=CALL, Strike=23800, Expiry=2025-01-09, Spot=23787.60
[2025-01-02 09:30:00] Checking entry: CE 23800, Expiry=2025-01-09
[2025-01-02 09:30:00] CE 23800: OI=2224350, Change=0 (0.00%) - BUILDING
[2025-01-02 09:33:00] üéØ ENTRY SIGNAL: CE 23800 - Price: 239.00, VWAP: 235.12, OI Change: -3375 (-0.15%)
[2025-01-02 09:33:00] üìà PLACING BUY ORDER: size=1, expected_price=239.00
[2025-01-02 09:34:00] üîµ BUY OPTION EXECUTED: CE 23800 @ ‚Çπ237.95 (Expiry: 2025-01-09, Lot size: 1)
[2025-01-02 10:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 10:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 11:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 11:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 12:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 12:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 13:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 13:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 14:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 14:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 14:50:00] END OF DAY - Closing all positions (size=1)
[2025-01-02 14:51:00] üî¥ SELL OPTION EXECUTED: CE 23800 @ ‚Çπ473.20 | Entry: ‚Çπ237.95 | P&L: ‚Çπ-235.25 (+98.87%)
[2025-01-02 14:51:00] TRADE PROFIT: Gross 416.50, Net 392.51
[2025-01-03 09:15:00] Starting daily analysis - Spot: 24152.65
[2025-01-03 09:15:00] Found expiry: 2025-01-09
[2025-01-03 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-03 09:15:00] Max Call OI: 24200, Max Put OI: 24000
[2025-01-03 09:15:00] Direction determined: CALL (Call dist: 47.35, Put dist: 152.65)
[2025-01-03 09:15:00] ‚úì Daily Analysis Complete: Direction=CALL, Strike=24200, Expiry=2025-01-09, Spot=24152.65
[2025-01-03 09:30:00] üìç STRIKE UPDATED: 24200 ‚Üí 24150 (Spot: 24130.85)
[2025-01-03 09:30:00] Checking entry: CE 24150, Expiry=2025-01-09
[2025-01-03 09:30:00] CE 24150: OI=2117625, Change=0 (0.00%) - BUILDING
[2025-01-03 09:35:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24094.30)
[2025-01-03 09:36:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24100.45)
[2025-01-03 09:38:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24095.85)
[2025-01-03 09:40:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24123.90)
[2025-01-03 09:44:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24083.40)
[2025-01-03 10:00:00] Checking entry: CE 24100, Expiry=2025-01-09
[2025-01-03 10:00:00] CE 24100: OI=4462950, Change=167550 (3.90%) - BUILDING
[2025-01-03 10:03:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24103.25)
[2025-01-03 10:07:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24072.90)
[2025-01-03 10:13:00] üìç STRIKE UPDATED: 24100 ‚Üí 24050 (Spot: 24037.25)
[2025-01-03 10:15:00] üìç STRIKE UPDATED: 24050 ‚Üí 24100 (Spot: 24050.05)
[2025-01-03 10:28:00] üìç STRIKE UPDATED: 24100 ‚Üí 24050 (Spot: 24047.45)
[2025-01-03 10:30:00] Checking entry: CE 24050, Expiry=2025-01-09
[2025-01-03 10:30:00] CE 24050: OI=2229600, Change=187875 (9.20%) - BUILDING
[2025-01-03 11:00:00] Checking entry: CE 24050, Expiry=2025-01-09
[2025-01-03 11:00:00] CE 24050: OI=2610300, Change=52650 (2.06%) - BUILDING
[2025-01-03 11:14:00] üìç STRIKE UPDATED: 24050 ‚Üí 24100 (Spot: 24057.70)
[2025-01-03 11:21:00] üéØ ENTRY SIGNAL: CE 24100 - Price: 160.15, VWAP: 158.49, OI Change: -76650 (-1.27%)
[2025-01-03 11:21:00] üìà PLACING BUY ORDER: size=1, expected_price=160.15
[2025-01-03 11:22:00] üîµ BUY OPTION EXECUTED: CE 24100 @ ‚Çπ161.65 (Expiry: 2025-01-09, Lot size: 1)
[2025-01-03 11:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-03 12:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-03 12:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-03 13:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-03 13:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-03 13:59:00] üõë STOP LOSS HIT: CE 24100 - Current: ‚Çπ120.15, Stop: ‚Çπ121.24
[2025-01-03 14:00:00] üî¥ SELL OPTION EXECUTED: CE 24100 @ ‚Çπ122.95 | Entry: ‚Çπ161.65 | P&L: ‚Çπ38.70 (-23.94%)
[2025-01-03 14:00:00] TRADE PROFIT: Gross -51.20, Net -75.27
[2025-01-03 14:00:00] üìç STRIKE UPDATED: 24100 ‚Üí 24050 (Spot: 24042.40)
[2025-01-03 14:00:00] Checking entry: CE 24050, Expiry=2025-01-09
[2025-01-03 14:00:00] CE 24050: OI=2607600, Change=-243675 (-8.55%) - UNWINDING ‚úì
[2025-01-03 14:00:00] CE 24050: Price=144.15, VWAP=173.99 - BELOW ‚úó
[2025-01-03 14:30:00] Checking entry: CE 24050, Expiry=2025-01-09
[2025-01-03 14:30:00] CE 24050: OI=2964900, Change=0 (0.00%) - BUILDING
[2025-01-06 09:15:00] Starting daily analysis - Spot: 24039.65
[2025-01-06 09:15:00] Found expiry: 2025-01-09
[2025-01-06 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-06 09:15:00] Max Call OI: 24200, Max Put OI: 24000
[2025-01-06 09:15:00] Direction determined: PUT (Call dist: 160.35, Put dist: 39.65)
[2025-01-06 09:15:00] ‚úì Daily Analysis Complete: Direction=PUT, Strike=24000, Expiry=2025-01-09, Spot=24039.65
[2025-01-06 09:30:00] üìç STRIKE UPDATED: 24000 ‚Üí 24050 (Spot: 24062.60)
[2025-01-06 09:30:00] Checking entry: PE 24050, Expiry=2025-01-09
[2025-01-06 09:30:00] PE 24050: OI=2489550, Change=0 (0.00%) - BUILDING
[2025-01-06 09:33:00] üìç STRIKE UPDATED: 24050 ‚Üí 24000 (Spot: 24049.55)
[2025-01-06 09:36:00] üìç STRIKE UPDATED: 24000 ‚Üí 23950 (Spot: 23988.75)
[2025-01-06 09:39:00] üìç STRIKE UPDATED: 23950 ‚Üí 24000 (Spot: 24020.90)
[2025-01-06 09:39:00] üéØ ENTRY SIGNAL: PE 24000 - Price: 199.20, VWAP: 163.34, OI Change: -1024125 (-13.78%)
[2025-01-06 09:39:00] üìà PLACING BUY ORDER: size=1, expected_price=199.20
[2025-01-06 09:40:00] üîµ BUY OPTION EXECUTED: PE 24000 @ ‚Çπ207.05 (Expiry: 2025-01-09, Lot size: 1)
[2025-01-06 10:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-06 10:08:00] üõë STOP LOSS HIT: PE 24000 - Current: ‚Çπ151.85, Stop: ‚Çπ155.29
[2025-01-06 10:09:00] üî¥ SELL OPTION EXECUTED: PE 24000 @ ‚Çπ151.30 | Entry: ‚Çπ207.05 | P&L: ‚Çπ55.75 (-26.93%)
[2025-01-06 10:09:00] TRADE PROFIT: Gross 4.45, Net -19.57
[2025-01-06 10:22:00] üìç STRIKE UPDATED: 24000 ‚Üí 23950 (Spot: 23993.30)
[2025-01-06 10:30:00] Checking entry: PE 23950, Expiry=2025-01-09
[2025-01-06 10:30:00] PE 23950: OI=2548575, Change=7425 (0.29%) - BUILDING
[2025-01-06 10:32:00] üìç STRIKE UPDATED: 23950 ‚Üí 23900 (Spot: 23948.15)
[2025-01-06 10:33:00] üéØ ENTRY SIGNAL: PE 23900 - Price: 138.85, VWAP: 126.30, OI Change: -152850 (-3.45%)
[2025-01-06 10:33:00] üìà PLACING BUY ORDER: size=1, expected_price=138.85
[2025-01-06 10:34:00] üîµ BUY OPTION EXECUTED: PE 23900 @ ‚Çπ140.15 (Expiry: 2025-01-09, Lot size: 1)
