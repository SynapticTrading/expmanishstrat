================================================================================
                    INTRADAY MOMENTUM OI UNWINDING STRATEGY
                              Backtest Runner
================================================================================

Loading configuration...
Configuration loaded from: config/strategy_config.yaml

Preparing data...
Loading spot price data...
Loaded 5625 spot price records from 2025-01-01 09:15:00 to 2025-01-21 15:29:00
Loading options data (this may take a while for large files)...
Loaded 1206944 options records
Filtered to 773758 weekly expiry option records

Data Summary:
  Spot data: 5625 bars from 2025-01-01 09:15:00 to 2025-01-21 15:29:00
  Options data: 773758 records
  Timeframe: 1 minute(s)

Initializing OI Analyzer...
Setting up Backtrader...
Initial Portfolio Value: ‚Çπ100,000.00

================================================================================
Running backtest...
================================================================================

Strategy initialized
[2025-01-01 09:15:00] Starting daily analysis - Spot: 23649.55
[2025-01-01 09:15:00] Found expiry: 2025-01-02
[2025-01-01 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-01 09:15:00] Max Call OI: 23800, Max Put OI: 23500
[2025-01-01 09:15:00] Direction determined: PUT (Call dist: 150.45, Put dist: 149.55)
[2025-01-01 09:15:00] ‚úì Daily Analysis Complete: Direction=PUT, Strike=23600, Expiry=2025-01-02, Spot=23649.55
[2025-01-01 09:30:00] Checking entry: PE 23600, Expiry=2025-01-02
[2025-01-01 09:30:00] PE 23600: OI=7673325, Change=0 (0.00%) - BUILDING
[2025-01-01 09:36:00] üéØ ENTRY SIGNAL: PE 23600 - Price: 103.50, VWAP: 97.47, OI Change: -186975 (-2.41%)
[2025-01-01 09:36:00] üìà PLACING BUY ORDER: size=1, expected_price=103.50
[2025-01-01 09:37:00] üîµ BUY OPTION EXECUTED: PE 23600 @ ‚Çπ103.40 (Expiry: 2025-01-02, Lot size: 1)
[2025-01-01 10:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 10:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 11:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 11:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 12:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 12:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 13:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 13:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 14:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 14:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-01 14:50:00] END OF DAY - Closing all positions (size=1)
[2025-01-01 14:51:00] üî¥ SELL OPTION EXECUTED: PE 23600 @ ‚Çπ52.25 | Entry: ‚Çπ103.40 | P&L: ‚Çπ51.15 (-49.47%)
[2025-01-01 14:51:00] TRADE PROFIT: Gross 135.40, Net 111.71
[2025-01-02 09:15:00] Starting daily analysis - Spot: 23787.60
[2025-01-02 09:15:00] Found expiry: 2025-01-09
[2025-01-02 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-02 09:15:00] Max Call OI: 23800, Max Put OI: 23700
[2025-01-02 09:15:00] Direction determined: CALL (Call dist: 12.40, Put dist: 87.60)
[2025-01-02 09:15:00] ‚úì Daily Analysis Complete: Direction=CALL, Strike=23800, Expiry=2025-01-09, Spot=23787.60
[2025-01-02 09:30:00] Checking entry: CE 23800, Expiry=2025-01-09
[2025-01-02 09:30:00] CE 23800: OI=2224350, Change=0 (0.00%) - BUILDING
[2025-01-02 09:33:00] üéØ ENTRY SIGNAL: CE 23800 - Price: 239.00, VWAP: 235.12, OI Change: -3375 (-0.15%)
[2025-01-02 09:33:00] üìà PLACING BUY ORDER: size=1, expected_price=239.00
[2025-01-02 09:34:00] üîµ BUY OPTION EXECUTED: CE 23800 @ ‚Çπ237.95 (Expiry: 2025-01-09, Lot size: 1)
[2025-01-02 10:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 10:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 11:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 11:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 12:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 12:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 13:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 13:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 14:00:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 14:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-02 14:50:00] END OF DAY - Closing all positions (size=1)
[2025-01-02 14:51:00] üî¥ SELL OPTION EXECUTED: CE 23800 @ ‚Çπ473.20 | Entry: ‚Çπ237.95 | P&L: ‚Çπ-235.25 (+98.87%)
[2025-01-02 14:51:00] TRADE PROFIT: Gross 416.50, Net 392.51
[2025-01-03 09:15:00] Starting daily analysis - Spot: 24152.65
[2025-01-03 09:15:00] Found expiry: 2025-01-09
[2025-01-03 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-03 09:15:00] Max Call OI: 24200, Max Put OI: 24000
[2025-01-03 09:15:00] Direction determined: CALL (Call dist: 47.35, Put dist: 152.65)
[2025-01-03 09:15:00] ‚úì Daily Analysis Complete: Direction=CALL, Strike=24200, Expiry=2025-01-09, Spot=24152.65
[2025-01-03 09:30:00] Checking entry: CE 24200, Expiry=2025-01-09
[2025-01-03 09:30:00] CE 24200: OI=5648025, Change=0 (0.00%) - BUILDING
[2025-01-03 10:00:00] Checking entry: CE 24200, Expiry=2025-01-09
[2025-01-03 10:00:00] CE 24200: OI=7094925, Change=97725 (1.40%) - BUILDING
[2025-01-03 10:30:00] Checking entry: CE 24200, Expiry=2025-01-09
[2025-01-03 10:30:00] CE 24200: OI=7762500, Change=164250 (2.16%) - BUILDING
[2025-01-03 11:00:00] Checking entry: CE 24200, Expiry=2025-01-09
[2025-01-03 11:00:00] CE 24200: OI=8550075, Change=28650 (0.34%) - BUILDING
[2025-01-03 11:24:00] üéØ ENTRY SIGNAL: CE 24200 - Price: 127.45, VWAP: 121.86, OI Change: -168150 (-2.11%)
[2025-01-03 11:24:00] üìà PLACING BUY ORDER: size=1, expected_price=127.45
[2025-01-03 11:25:00] üîµ BUY OPTION EXECUTED: CE 24200 @ ‚Çπ122.45 (Expiry: 2025-01-09, Lot size: 1)
[2025-01-03 11:30:00] ‚ö†Ô∏è  Already in position: size=1
[2025-01-03 12:00:00] ‚ö†Ô∏è  Already in position: size=1
