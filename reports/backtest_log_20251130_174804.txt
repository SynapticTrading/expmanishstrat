================================================================================
                    INTRADAY MOMENTUM OI UNWINDING STRATEGY
                              Backtest Runner
================================================================================

Loading configuration...
Configuration loaded from: config/strategy_config.yaml

Preparing data...
Loading spot price data...
Loaded 8625 spot price records from 2025-01-01 09:15:00 to 2025-01-31 15:29:00
Loading options data (this may take a while for large files)...
Loaded 3195409 options records
‚úì Sorted options data for fast lookups
Filtered to 1720094 weekly expiry option records

Data Summary:
  Spot data: 8625 bars from 2025-01-01 09:15:00 to 2025-01-31 15:29:00
  Options data: 1720094 records
  Timeframe: 1 minute(s)

Initializing OI Analyzer...
Setting up Backtrader...
Initial Portfolio Value: ‚Çπ100,000.00

================================================================================
Running backtest...
================================================================================

Trade log will be saved to: reports/trades_20251130_174948.csv
Strategy initialized
[2025-01-31 15:29:00] Starting with capital: ‚Çπ100,000.00
[2025-01-01 09:15:00] Starting daily analysis - Spot: 23649.55
[2025-01-01 09:15:00] Found expiry: 2025-01-02
[2025-01-01 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-01 09:15:00] Max Call OI: 23800, Max Put OI: 23500
[2025-01-01 09:15:00] Direction determined: PUT (Call dist: 150.45, Put dist: 149.55)
[2025-01-01 09:15:00] ‚úì Daily Analysis Complete: Direction=PUT, Strike=23600, Expiry=2025-01-02, Spot=23649.55
[2025-01-01 09:30:00] Checking entry: PE 23600, Expiry=2025-01-02
[2025-01-01 09:30:00] PE 23600: OI=7673325, Change=0 (0.00%) - BUILDING
[2025-01-01 09:36:00] üì¶ Cached 44118 options records for 2025-01-01
[2025-01-01 09:36:00] üéØ ENTRY SIGNAL: PE 23600 - Price: 103.50, VWAP: 97.47, OI Change: -186975 (-2.41%)
[2025-01-01 09:36:00] üìà PLACING BUY ORDER: size=1, expected_price=103.50
[2025-01-01 09:37:00] üîµ BUY OPTION EXECUTED: PE 23600 @ ‚Çπ103.50 (Expiry: 2025-01-02, Lot size: 1)
[2025-01-01 14:50:00] END OF DAY - Closing all positions (size=-1)
[2025-01-01 14:50:00] üî¥ SELL OPTION EXECUTED: PE 23600 @ ‚Çπ53.30 | Entry: ‚Çπ103.50 | P&L: ‚Çπ-50.20 (-48.50%) | Reason: EOD Exit
[2025-01-01 14:50:00] TRADE PROFIT: Gross -50.20, Net -50.20
[2025-01-01 14:50:00] Current Capital: ‚Çπ99,949.80
[2025-01-02 09:15:00] Starting daily analysis - Spot: 23787.60
[2025-01-02 09:15:00] Found expiry: 2025-01-02
[2025-01-02 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-02 09:15:00] Max Call OI: 24000, Max Put OI: 23600
[2025-01-02 09:15:00] Direction determined: PUT (Call dist: 212.40, Put dist: 187.60)
[2025-01-02 09:15:00] ‚úì Daily Analysis Complete: Direction=PUT, Strike=23750, Expiry=2025-01-02, Spot=23787.60
[2025-01-02 09:30:00] Checking entry: PE 23750, Expiry=2025-01-02
[2025-01-02 09:30:00] PE 23750: OI=5155575, Change=0 (0.00%) - BUILDING
[2025-01-02 09:37:00] üìç STRIKE UPDATED: 23750 ‚Üí 23800 (Spot: 23818.65)
[2025-01-02 09:51:00] üì¶ Cached 46008 options records for 2025-01-02
[2025-01-02 09:52:00] üìç STRIKE UPDATED: 23800 ‚Üí 23750 (Spot: 23798.15)
[2025-01-02 09:54:00] üìç STRIKE UPDATED: 23750 ‚Üí 23800 (Spot: 23817.85)
[2025-01-02 10:00:00] Checking entry: PE 23800, Expiry=2025-01-02
[2025-01-02 10:00:00] PE 23800: OI=9446550, Change=315375 (3.45%) - BUILDING
[2025-01-02 10:05:00] üìç STRIKE UPDATED: 23800 ‚Üí 23850 (Spot: 23850.40)
[2025-01-02 10:09:00] üìç STRIKE UPDATED: 23850 ‚Üí 23800 (Spot: 23842.15)
[2025-01-02 10:12:00] üìç STRIKE UPDATED: 23800 ‚Üí 23850 (Spot: 23869.30)
[2025-01-02 10:13:00] üìç STRIKE UPDATED: 23850 ‚Üí 23800 (Spot: 23848.10)
[2025-01-02 10:16:00] üìç STRIKE UPDATED: 23800 ‚Üí 23850 (Spot: 23853.20)
[2025-01-02 10:30:00] Checking entry: PE 23850, Expiry=2025-01-02
[2025-01-02 10:30:00] PE 23850: OI=6557925, Change=186075 (2.92%) - BUILDING
[2025-01-02 10:49:00] üìç STRIKE UPDATED: 23850 ‚Üí 23900 (Spot: 23913.90)
[2025-01-02 11:00:00] Checking entry: PE 23900, Expiry=2025-01-02
[2025-01-02 11:00:00] PE 23900: OI=9715125, Change=559950 (6.12%) - BUILDING
[2025-01-02 11:10:00] üìç STRIKE UPDATED: 23900 ‚Üí 23950 (Spot: 23951.55)
[2025-01-02 11:11:00] üìç STRIKE UPDATED: 23950 ‚Üí 23900 (Spot: 23946.25)
[2025-01-02 11:24:00] üìç STRIKE UPDATED: 23900 ‚Üí 23950 (Spot: 23950.15)
[2025-01-02 11:30:00] Checking entry: PE 23950, Expiry=2025-01-02
[2025-01-02 11:30:00] PE 23950: OI=5837475, Change=134100 (2.35%) - BUILDING
[2025-01-02 11:47:00] üìç STRIKE UPDATED: 23950 ‚Üí 23900 (Spot: 23943.85)
[2025-01-02 12:00:00] üìç STRIKE UPDATED: 23900 ‚Üí 23950 (Spot: 23960.65)
[2025-01-02 12:00:00] Checking entry: PE 23950, Expiry=2025-01-02
[2025-01-02 12:00:00] PE 23950: OI=6940350, Change=355800 (5.40%) - BUILDING
[2025-01-02 12:14:00] üìç STRIKE UPDATED: 23950 ‚Üí 23900 (Spot: 23940.45)
[2025-01-02 12:20:00] üìç STRIKE UPDATED: 23900 ‚Üí 23950 (Spot: 23953.85)
[2025-01-02 12:28:00] üìç STRIKE UPDATED: 23950 ‚Üí 24000 (Spot: 24008.60)
[2025-01-02 12:30:00] Checking entry: PE 24000, Expiry=2025-01-02
[2025-01-02 12:30:00] PE 24000: OI=6798975, Change=0 (0.00%) - BUILDING
[2025-01-02 12:31:00] üìç STRIKE UPDATED: 24000 ‚Üí 24050 (Spot: 24058.35)
[2025-01-02 12:32:00] üìç STRIKE UPDATED: 24050 ‚Üí 24000 (Spot: 24043.00)
[2025-01-02 12:38:00] üìç STRIKE UPDATED: 24000 ‚Üí 24050 (Spot: 24050.30)
[2025-01-02 12:47:00] üìç STRIKE UPDATED: 24050 ‚Üí 24000 (Spot: 24045.90)
[2025-01-02 12:48:00] üìç STRIKE UPDATED: 24000 ‚Üí 24050 (Spot: 24051.95)
[2025-01-02 12:49:00] üìç STRIKE UPDATED: 24050 ‚Üí 24000 (Spot: 24048.55)
[2025-01-02 12:52:00] üìç STRIKE UPDATED: 24000 ‚Üí 24050 (Spot: 24053.65)
[2025-01-02 12:57:00] üìç STRIKE UPDATED: 24050 ‚Üí 24000 (Spot: 24048.30)
[2025-01-02 12:58:00] üìç STRIKE UPDATED: 24000 ‚Üí 24050 (Spot: 24051.50)
[2025-01-02 13:00:00] Checking entry: PE 24050, Expiry=2025-01-02
[2025-01-02 13:00:00] PE 24050: OI=4975425, Change=0 (0.00%) - BUILDING
[2025-01-02 13:19:00] üìç STRIKE UPDATED: 24050 ‚Üí 24100 (Spot: 24106.60)
[2025-01-02 13:29:00] üìç STRIKE UPDATED: 24100 ‚Üí 24050 (Spot: 24099.85)
[2025-01-02 13:30:00] Checking entry: PE 24050, Expiry=2025-01-02
[2025-01-02 13:30:00] PE 24050: OI=7438275, Change=0 (0.00%) - BUILDING
[2025-01-02 13:33:00] üìç STRIKE UPDATED: 24050 ‚Üí 24100 (Spot: 24108.05)
[2025-01-02 13:48:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24150.60)
[2025-01-02 13:49:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24143.05)
[2025-01-02 14:00:00] Checking entry: PE 24100, Expiry=2025-01-02
[2025-01-02 14:00:00] PE 24100: OI=20686200, Change=0 (0.00%) - BUILDING
[2025-01-02 14:12:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24151.05)
[2025-01-02 14:14:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24144.70)
[2025-01-02 14:15:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24151.30)
[2025-01-02 14:30:00] Checking entry: PE 24150, Expiry=2025-01-02
[2025-01-02 14:30:00] PE 24150: OI=18388950, Change=0 (0.00%) - BUILDING
[2025-01-03 09:15:00] Starting daily analysis - Spot: 24152.65
[2025-01-03 09:15:00] Found expiry: 2025-01-09
[2025-01-03 09:15:00] Found 20 options near spot, 10 strikes
[2025-01-03 09:15:00] Max Call OI: 24200, Max Put OI: 24000
[2025-01-03 09:15:00] Direction determined: CALL (Call dist: 47.35, Put dist: 152.65)
[2025-01-03 09:15:00] ‚úì Daily Analysis Complete: Direction=CALL, Strike=24200, Expiry=2025-01-09, Spot=24152.65
[2025-01-03 09:30:00] üìç STRIKE UPDATED: 24200 ‚Üí 24150 (Spot: 24130.85)
[2025-01-03 09:30:00] Checking entry: CE 24150, Expiry=2025-01-09
[2025-01-03 09:30:00] CE 24150: OI=2117625, Change=0 (0.00%) - BUILDING
[2025-01-03 09:35:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24094.30)
[2025-01-03 09:36:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24100.45)
[2025-01-03 09:38:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24095.85)
[2025-01-03 09:40:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24123.90)
[2025-01-03 09:44:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24083.40)
[2025-01-03 10:00:00] Checking entry: CE 24100, Expiry=2025-01-09
[2025-01-03 10:00:00] CE 24100: OI=4462950, Change=167550 (3.90%) - BUILDING
[2025-01-03 10:03:00] üìç STRIKE UPDATED: 24100 ‚Üí 24150 (Spot: 24103.25)
[2025-01-03 10:07:00] üìç STRIKE UPDATED: 24150 ‚Üí 24100 (Spot: 24072.90)
[2025-01-03 10:09:00] üì¶ Cached 43744 options records for 2025-01-03
[2025-01-03 10:13:00] üìç STRIKE UPDATED: 24100 ‚Üí 24050 (Spot: 24037.25)
[2025-01-03 10:15:00] üìç STRIKE UPDATED: 24050 ‚Üí 24100 (Spot: 24050.05)
[2025-01-03 10:28:00] üìç STRIKE UPDATED: 24100 ‚Üí 24050 (Spot: 24047.45)
[2025-01-03 10:30:00] Checking entry: CE 24050, Expiry=2025-01-09
[2025-01-03 10:30:00] CE 24050: OI=2229600, Change=187875 (9.20%) - BUILDING
[2025-01-03 11:00:00] Checking entry: CE 24050, Expiry=2025-01-09
[2025-01-03 11:00:00] CE 24050: OI=2610300, Change=52650 (2.06%) - BUILDING
[2025-01-03 11:14:00] üìç STRIKE UPDATED: 24050 ‚Üí 24100 (Spot: 24057.70)
[2025-01-03 11:21:00] üéØ ENTRY SIGNAL: CE 24100 - Price: 160.15, VWAP: 158.49, OI Change: -76650 (-1.27%)
[2025-01-03 11:21:00] üìà PLACING BUY ORDER: size=1, expected_price=160.15
[2025-01-03 11:22:00] üîµ BUY OPTION EXECUTED: CE 24100 @ ‚Çπ160.15 (Expiry: 2025-01-09, Lot size: 1)
