/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2025-12-31 15:11:46.821556+05:30] Checking for previous session...
[2025-12-31 15:11:46.821639+05:30] No previous state found - starting fresh

[2025-12-31 15:11:46.821651+05:30] Connecting to Zerodha...
[2025-12-31 15:11:46.821662] Connecting to Zerodha...
[2025-12-31 15:11:47.046076] Generated TOTP: 235267
[2025-12-31 15:11:47.147637] ‚úì Request token extracted from redirect
[2025-12-31 15:11:47.147669] Request token obtained: KG7QZoni7isQemiaDjHu...
[2025-12-31 15:11:47.229271] ‚úì Connection successful!
[2025-12-31 15:11:47.229289] Access Token: 6RoKkTu8b03NPFC4Dw5x...
[2025-12-31 15:11:47.229309] Zerodha data feed initialized
[2025-12-31 15:11:47.229316+05:30] ‚úì Connected to Zerodha

[2025-12-31 15:11:47.229334+05:30] Initializing new session...
[2025-12-31 15:11:47.230033+05:30] üìä PORTFOLIO CARRYOVER
  Previous Date: 2025-12-30
  Starting Capital: ‚Çπ100,127.50
  Previous P&L: ‚Çπ+127.50
  Previous Trades: 1
  Previous Win Rate: 100.0%
[2025-12-31 15:11:47.230436+05:30] Session initialized: SESSION_20251231_1511
[2025-12-31 15:11:47.230449+05:30] State file: paper_trading/state/trading_state_20251231.json
[2025-12-31 15:11:47.230467+05:30] Loading instruments...
[2025-12-31 15:11:47.230475] Loading instruments...
[2025-12-31 15:11:47.230480] Fetching instruments for NFO...
[2025-12-31 15:11:48.282056] ‚úì Retrieved 37220 instruments
[2025-12-31 15:11:48.287138] Fetching instruments for NSE...
[2025-12-31 15:11:48.455584] ‚úì Retrieved 9058 instruments
[2025-12-31 15:11:48.458857] ‚úì Nifty 50 token: 256265
[2025-12-31 15:11:48.458881] ‚úì Instruments loaded
[2025-12-31 15:11:48.458890+05:30] Initializing paper broker...
[2025-12-31 15:11:48.459424] Paper Broker initialized with capital: ‚Çπ100,127.50
[2025-12-31 15:11:48.459441] Daily trade log: paper_trading/logs/trades_20251231_151148.csv
[2025-12-31 15:11:48.459445] Cumulative trade log: paper_trading/logs/trades_cumulative.csv
[2025-12-31 15:11:48.459455+05:30] Initializing OI analyzer...
[2025-12-31 15:11:48.459820+05:30] Initializing strategy...
[2025-12-31 15:11:48.459854] Strategy initialized
  Entry: 09:30:00 - 15:28:00
  Exit: 15:29:00 - 15:30:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2025-12-31 15:11:48.460155+05:30] ‚úì All components initialized

================================================================================
[2025-12-31 15:11:48.460172+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2025-12-31 15:11:48.460318+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2025-12-31 15:11:48.460365+05:30] ‚úì Exit monitor loop started
[2025-12-31 15:11:48.460715+05:30] ‚úì Strategy loop started

================================================================================
[2025-12-31 15:11:48.460735+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-31 15:11:48.460735+05:30] Nifty Spot: 26121.70
[2025-12-31 15:11:48.608848] Fetching quotes for 22 options...
[2025-12-31 15:11:48.651009] ‚úì Retrieved 22 option quotes

================================================================================
[2025-12-31 15:11:48.460735+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2025-12-31 15:11:48.460735+05:30] Determining direction using CURRENT OI data...
[2025-12-31 15:11:48.460735+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2025-12-31 15:11:48.460735+05:30] NEW TRADING DAY: 2025-12-31
================================================================================

================================================================================
OI DISTRIBUTION DEBUG (Spot: 26121.70)
================================================================================

CALL OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
25850.0            272,870            -271.70
25900.0          1,234,220            -221.70
25950.0            833,560            -171.70
26000.0          4,863,885            -121.70
26050.0          1,775,800             -71.70
26100.0          4,863,885             -21.70
26150.0          4,408,365              28.30
26200.0          7,700,290              78.30 üëà MAX
26250.0          2,954,250             128.30
26300.0          5,945,745             178.30
26350.0          2,613,260             228.30

PUT OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
25850.0          4,524,715             271.70
25900.0          8,531,965             221.70
25950.0          5,843,240             171.70
26000.0         17,726,475             121.70 üëà MAX
26050.0          8,346,780              71.70
26100.0         11,215,490              21.70
26150.0          5,839,275             -28.30
26200.0          6,507,215             -78.30
26250.0          1,391,325            -128.30
26300.0          2,296,905            -178.30
26350.0            438,035            -228.30
================================================================================

[2025-12-31 15:11:48.460735+05:30] Max Call OI: 7,700,290 @ 26200.0, Max Put OI: 17,726,475 @ 26000.0
[2025-12-31 15:11:48.460735+05:30] Direction determined: CALL (Call dist: 78.30, Put dist: 121.70)
[2025-12-31 15:11:48.460735+05:30] ‚úì Daily Analysis Complete: Direction=CALL, Strike=26150.0, Expiry=2026-01-06, Spot=26121.70
[2025-12-31 15:11:48.460735+05:30] üîÑ Reset VWAP running totals for new day: 2025-12-31
[2025-12-31 15:11:48.460735+05:30] üéØ Initialized VWAP for CALL 26150.0: 72 bars from 9:15 AM
[2025-12-31 15:11:48.460735+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2025-12-31 15:11:48.460735+05:30] CALL 26150.0: OI=4,408,365, Change=0 (+0.00%) - BUILDING
[2025-12-31 15:11:48.460735+05:30] CALL 26150.0: Price=‚Çπ112.20, VWAP=‚Çπ112.20 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-31
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:11:48] Waiting 191s for next candle at 15:15:00

================================================================================
[2025-12-31 15:15:00.002278+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-31 15:15:00.002278+05:30] Nifty Spot: 26122.95
[2025-12-31 15:15:00.048345] Fetching quotes for 22 options...
[2025-12-31 15:15:00.081450] ‚úì Retrieved 22 option quotes
[2025-12-31 15:15:00.002278+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2025-12-31 15:15:00.002278+05:30] CALL 26150.0: OI=4,425,395, Change=17,030 (+0.39%) - BUILDING
[2025-12-31 15:15:00.002278+05:30] CALL 26150.0: Price=‚Çπ113.30, VWAP=‚Çπ112.75 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-31
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:15:00] Waiting 300s for next candle at 15:20:00

================================================================================
[2025-12-31 15:20:00.009960+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-31 15:20:30.043700] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-31 15:20:30.043769] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-31 15:20:00.009960+05:30] Nifty Spot: 26124.70
[2025-12-31 15:20:31.135629] Fetching quotes for 22 options...
[2025-12-31 15:20:31.171898] ‚úì Retrieved 22 option quotes
[2025-12-31 15:20:00.009960+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2025-12-31 15:20:00.009960+05:30] CALL 26150.0: OI=4,178,395, Change=-229,970 (-5.22%) - UNWINDING ‚úì
[2025-12-31 15:20:00.009960+05:30] CALL 26150.0: Price=‚Çπ112.30, VWAP=‚Çπ112.60 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-31
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:20:31] Waiting 269s for next candle at 15:25:00

================================================================================
[2025-12-31 15:25:00.007053+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-31 15:25:26.050623] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-31 15:25:26.050688] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-31 15:25:00.007053+05:30] Nifty Spot: 26128.60
[2025-12-31 15:25:27.133493] Fetching quotes for 22 options...
[2025-12-31 15:25:27.191472] ‚úì Retrieved 22 option quotes
[2025-12-31 15:25:00.007053+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2025-12-31 15:25:00.007053+05:30] CALL 26150.0: OI=4,159,805, Change=-248,560 (-5.64%) - UNWINDING ‚úì
[2025-12-31 15:25:00.007053+05:30] CALL 26150.0: Price=‚Çπ112.70, VWAP=‚Çπ112.62 - ABOVE ‚úì
[2025-12-31 15:25:00.007053+05:30] üéØ ENTRY SIGNAL: CALL 26150.0 - Price: 112.70, VWAP: 112.62, OI Change: -248,560 (-5.64%)
[2025-12-31 15:25:00.007053+05:30] üìà PLACING BUY ORDER: size=1, expected_price=112.70
[2025-12-31 15:25:27.193640] ‚úì BUY ORDER EXECUTED
  Strike: 26150.0 CALL
  Expiry: 2026-01-06
  Entry Price: ‚Çπ112.70
  Size: 75
  Cost: ‚Çπ8,452.50
  VWAP: ‚Çπ112.62
  OI: 4,159,805 (Change: -563.84%)
  Remaining Cash: ‚Çπ91,675.00
[2025-12-31 15:25:00.007053+05:30] üîµ BUY OPTION EXECUTED: CALL 26150.0 @ ‚Çπ112.70 (Expiry: 2026-01-06, 1 lot = 75 qty)
[2025-12-31 15:25:00.007053+05:30]    üìä ENTRY DATA: VWAP=112.62, OI=4,159,805, OI Change=-248,560 (-5.64%)

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-31
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 1
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:25:27] Waiting 273s for next candle at 15:30:00
[2025-12-31 15:25:48.528161+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2025-12-31 15:25:48.590820] Fetching quotes for 22 options...
[2025-12-31 15:25:48.629548] ‚úì Retrieved 22 option quotes
[2025-12-31 15:25:48.528161+05:30] üìä LTP CHECK: 26150.0 CALL
    Current LTP: ‚Çπ112.70 | Entry: ‚Çπ112.70 | P&L: +0.00%
    Initial Stop: ‚Çπ84.53 (distance: 33.33%)
[2025-12-31 15:26:48.634730+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2025-12-31 15:26:48.710700] Fetching quotes for 22 options...
[2025-12-31 15:26:48.755813] ‚úì Retrieved 22 option quotes
[2025-12-31 15:26:48.634730+05:30] üìä LTP CHECK: 26150.0 CALL
    Current LTP: ‚Çπ114.20 | Entry: ‚Çπ112.70 | P&L: +1.33%
    Initial Stop: ‚Çπ84.53 (distance: 35.11%)
[2025-12-31 15:27:48.759526+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2025-12-31 15:27:54.488671] Fetching quotes for 22 options...
[2025-12-31 15:27:58.298172] ‚úì Retrieved 22 option quotes
[2025-12-31 15:27:48.759526+05:30] üìä LTP CHECK: 26150.0 CALL
    Current LTP: ‚Çπ114.70 | Entry: ‚Çπ112.70 | P&L: +1.77%
    Initial Stop: ‚Çπ84.53 (distance: 35.70%)
[2025-12-31 15:28:58.301075+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2025-12-31 15:28:58.362056] Fetching quotes for 22 options...
[2025-12-31 15:28:58.519848] ‚úì Retrieved 22 option quotes
[2025-12-31 15:28:58.301075+05:30] üìä LTP CHECK: 26150.0 CALL
    Current LTP: ‚Çπ114.65 | Entry: ‚Çπ112.70 | P&L: +1.73%
    Initial Stop: ‚Çπ84.53 (distance: 35.64%)
[2025-12-31 15:29:58.525264+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2025-12-31 15:29:58.588495] Fetching quotes for 22 options...
[2025-12-31 15:29:58.633417] ‚úì Retrieved 22 option quotes
[2025-12-31 15:29:58.525264+05:30] üîî END OF DAY EXIT TIME - Forcing exit
[2025-12-31 15:29:58.636198] ‚úì SELL ORDER EXECUTED
  Strike: 26150.0 CALL
  Exit Price: ‚Çπ115.00
  P&L: ‚Çπ+172.50 (+2.04%)
  Exit Reason: EOD Exit
  Cash: ‚Çπ100,300.00
[2025-12-31 15:30:00.004989+05:30] Market closed, stopping...

================================================================================
[2025-12-31 15:30:00.005122+05:30] Shutting down...
================================================================================

Final Statistics:
  Total Trades: 1
  Win Rate: 100.0%
  Total P&L: ‚Çπ172.50
  ROI: +0.17%
[2025-12-31 15:30:05.006867] Logging out...
[2025-12-31 15:30:05.040948] ‚úì Logged out successfully

[2025-12-31 15:30:05.040979+05:30] ‚úì Shutdown complete
