/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2025-12-30 14:33:31.524852+05:30] Checking for previous session...
[2025-12-30 14:33:31.524940+05:30] No previous state found - starting fresh

[2025-12-30 14:33:31.524951+05:30] Connecting to Zerodha...
[2025-12-30 14:33:31.524963] Connecting to Zerodha...
[2025-12-30 14:33:31.752485] Generated TOTP: 715048
[2025-12-30 14:33:31.835515] ‚úì Request token extracted from redirect
[2025-12-30 14:33:31.835531] Request token obtained: 8PK2rrF0l9HTIz5Qh5qg...
[2025-12-30 14:33:31.903806] ‚úì Connection successful!
[2025-12-30 14:33:31.903820] Access Token: HVGU6h8Ixfzs8ojX6qSv...
[2025-12-30 14:33:31.903840] Zerodha data feed initialized
[2025-12-30 14:33:31.903845+05:30] ‚úì Connected to Zerodha

[2025-12-30 14:33:31.903866+05:30] Initializing new session...
[2025-12-30 14:33:31.904365+05:30] Session initialized: SESSION_20251230_1433
[2025-12-30 14:33:31.904385+05:30] State file: paper_trading/state/trading_state_20251230.json
[2025-12-30 14:33:31.904408+05:30] Loading instruments...
[2025-12-30 14:33:31.904417] Loading instruments...
[2025-12-30 14:33:31.904423] Fetching instruments for NFO...
[2025-12-30 14:33:33.033356] ‚úì Retrieved 38222 instruments
[2025-12-30 14:33:33.039960] Fetching instruments for NSE...
[2025-12-30 14:33:33.167011] ‚úì Retrieved 9057 instruments
[2025-12-30 14:33:33.169121] ‚úì Nifty 50 token: 256265
[2025-12-30 14:33:33.169139] ‚úì Instruments loaded
[2025-12-30 14:33:33.169147+05:30] Initializing paper broker...
[2025-12-30 14:33:33.169572] Paper Broker initialized with capital: ‚Çπ100,000.00
[2025-12-30 14:33:33.169584] Trade log: paper_trading/logs/trades_20251230_143333.csv
[2025-12-30 14:33:33.169594+05:30] Initializing OI analyzer...
[2025-12-30 14:33:33.169888+05:30] Initializing strategy...
[2025-12-30 14:33:33.169914] Strategy initialized
  Entry: 09:30:00 - 15:29:00
  Exit: 15:29:00 - 15:30:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2025-12-30 14:33:33.170185+05:30] ‚úì All components initialized

================================================================================
[2025-12-30 14:33:33.170200+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2025-12-30 14:33:33.170300+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2025-12-30 14:33:33.170334+05:30] ‚úì Exit monitor loop started
[2025-12-30 14:33:33.170538+05:30] ‚úì Strategy loop started

================================================================================
[2025-12-30 14:33:33.170548+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:33:33.170548+05:30] Nifty Spot: 25933.55
[2025-12-30 14:33:33.226018] Fetching quotes for 22 options...
[2025-12-30 14:33:33.261901] ‚úì Retrieved 22 option quotes

================================================================================
[2025-12-30 14:33:33.170548+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2025-12-30 14:33:33.170548+05:30] Determining direction using CURRENT OI data...
[2025-12-30 14:33:33.170548+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2025-12-30 14:33:33.170548+05:30] NEW TRADING DAY: 2025-12-30
================================================================================
[2025-12-30 14:33:33.170548+05:30] Max Call OI: 39,771,950 @ 26000.0, Max Put OI: 49,905,525 @ 25900.0
[2025-12-30 14:33:33.170548+05:30] Direction determined: PUT (Call dist: 66.45, Put dist: 33.55)
[2025-12-30 14:33:33.170548+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=25900.0, Expiry=2025-12-30, Spot=25933.55
[2025-12-30 14:33:33.170548+05:30] üîÑ Reset VWAP running totals for new day: 2025-12-30
[2025-12-30 14:33:33.170548+05:30] üéØ Initialized VWAP for PUT 25900.0: 64 bars from 9:15 AM
[2025-12-30 14:33:33.170548+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 14:33:33.170548+05:30] PUT 25900.0: OI=49,905,525, Change=0 (+0.00%) - BUILDING
[2025-12-30 14:33:33.170548+05:30] PUT 25900.0: Price=‚Çπ3.20, VWAP=‚Çπ3.20 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:33:33] Waiting 87s for next candle at 14:35:00

================================================================================
[2025-12-30 14:35:00.005451+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:35:00.005451+05:30] Nifty Spot: 25936.55
[2025-12-30 14:35:00.056592] Fetching quotes for 22 options...
[2025-12-30 14:35:00.093565] ‚úì Retrieved 22 option quotes
[2025-12-30 14:35:00.005451+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 14:35:00.005451+05:30] PUT 25900.0: OI=49,905,525, Change=0 (+0.00%) - BUILDING
[2025-12-30 14:35:00.005451+05:30] PUT 25900.0: Price=‚Çπ2.90, VWAP=‚Çπ3.05 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:35:00] Waiting 300s for next candle at 14:40:00

================================================================================
[2025-12-30 14:40:00.001662+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:40:30.013789] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-30 14:40:30.013852] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 14:40:00.001662+05:30] Nifty Spot: 25934.75
[2025-12-30 14:40:31.123886] Fetching quotes for 22 options...
[2025-12-30 14:40:31.154911] ‚úì Retrieved 22 option quotes
[2025-12-30 14:40:00.001662+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 14:40:00.001662+05:30] PUT 25900.0: OI=52,087,275, Change=2,181,750 (+4.37%) - BUILDING
[2025-12-30 14:40:00.001662+05:30] PUT 25900.0: Price=‚Çπ3.45, VWAP=‚Çπ3.19 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:40:31] Waiting 269s for next candle at 14:45:00

================================================================================
[2025-12-30 14:45:00.006283+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:45:21.669031] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 14:45:21.669112] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 14:45:00.006283+05:30] Nifty Spot: 25940.40
[2025-12-30 14:45:22.782934] Fetching quotes for 22 options...
[2025-12-30 14:45:22.834546] ‚úì Retrieved 22 option quotes
[2025-12-30 14:45:00.006283+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 14:45:00.006283+05:30] PUT 25900.0: OI=49,122,075, Change=-783,450 (-1.57%) - UNWINDING ‚úì
[2025-12-30 14:45:00.006283+05:30] PUT 25900.0: Price=‚Çπ1.90, VWAP=‚Çπ2.85 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:45:22] Waiting 277s for next candle at 14:50:00

================================================================================
[2025-12-30 14:50:00.006301+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:50:25.032726] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 14:50:25.032799] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 14:50:00.006301+05:30] Nifty Spot: 25951.80
[2025-12-30 14:50:26.117644] Fetching quotes for 22 options...
[2025-12-30 14:50:26.157210] ‚úì Retrieved 22 option quotes
[2025-12-30 14:50:00.006301+05:30] üìç STRIKE UPDATED: 25900.0 ‚Üí 25950.0 (Spot: 25951.80)
[2025-12-30 14:50:00.006301+05:30] üéØ Initialized VWAP for PUT 25950.0: 68 bars from 9:15 AM
[2025-12-30 14:50:00.006301+05:30] Checking entry: PUT 25950.0, Expiry=2025-12-30
[2025-12-30 14:50:00.006301+05:30] PUT 25950.0: OI=24,300,000, Change=0 (+0.00%) - BUILDING
[2025-12-30 14:50:00.006301+05:30] PUT 25950.0: Price=‚Çπ9.10, VWAP=‚Çπ9.10 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25950.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:50:26] Waiting 274s for next candle at 14:55:00

================================================================================
[2025-12-30 14:55:00.006245+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:55:27.131497] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 14:55:27.131570] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 14:55:00.006245+05:30] Nifty Spot: 25944.60
[2025-12-30 14:55:28.249906] Fetching quotes for 22 options...
[2025-12-30 14:55:28.288384] ‚úì Retrieved 22 option quotes
[2025-12-30 14:55:00.006245+05:30] üìç STRIKE UPDATED: 25950.0 ‚Üí 25900.0 (Spot: 25944.60)
[2025-12-30 14:55:00.006245+05:30] üéØ Initialized VWAP for PUT 25900.0: 69 bars from 9:15 AM
[2025-12-30 14:55:00.006245+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 14:55:00.006245+05:30] PUT 25900.0: OI=41,756,850, Change=0 (+0.00%) - BUILDING
[2025-12-30 14:55:00.006245+05:30] PUT 25900.0: Price=‚Çπ1.10, VWAP=‚Çπ2.46 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:55:28] Waiting 272s for next candle at 15:00:00

================================================================================
[2025-12-30 15:00:00.006351+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 15:00:30.012622] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-30 15:00:30.012648] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 15:00:00.006351+05:30] Nifty Spot: 25936.70
[2025-12-30 15:00:31.090409] Fetching quotes for 22 options...
[2025-12-30 15:00:31.143124] ‚úì Retrieved 22 option quotes
[2025-12-30 15:00:00.006351+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 15:00:00.006351+05:30] PUT 25900.0: OI=42,666,825, Change=909,975 (+2.18%) - BUILDING
[2025-12-30 15:00:00.006351+05:30] PUT 25900.0: Price=‚Çπ0.95, VWAP=‚Çπ2.18 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:00:31] Waiting 269s for next candle at 15:05:00

================================================================================
[2025-12-30 15:05:00.006242+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 15:05:30.024360] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-30 15:05:30.024428] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 15:05:00.006242+05:30] Nifty Spot: 25942.25
[2025-12-30 15:05:31.105078] Fetching quotes for 22 options...
[2025-12-30 15:05:31.136490] ‚úì Retrieved 22 option quotes
[2025-12-30 15:05:00.006242+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 15:05:00.006242+05:30] PUT 25900.0: OI=42,919,500, Change=1,162,650 (+2.78%) - BUILDING
[2025-12-30 15:05:00.006242+05:30] PUT 25900.0: Price=‚Çπ0.35, VWAP=‚Çπ1.88 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:05:31] Waiting 269s for next candle at 15:10:00

================================================================================
[2025-12-30 15:10:00.001675+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 15:10:21.928065] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 15:10:21.928138] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 15:10:00.001675+05:30] Nifty Spot: 25936.55
[2025-12-30 15:10:23.027272] Fetching quotes for 22 options...
[2025-12-30 15:10:23.068757] ‚úì Retrieved 22 option quotes
[2025-12-30 15:10:00.001675+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 15:10:00.001675+05:30] PUT 25900.0: OI=37,518,300, Change=-4,238,550 (-10.15%) - UNWINDING ‚úì
[2025-12-30 15:10:00.001675+05:30] PUT 25900.0: Price=‚Çπ0.20, VWAP=‚Çπ1.65 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:10:23] Waiting 277s for next candle at 15:15:00

================================================================================
[2025-12-30 15:15:00.006262+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 15:15:30.027066] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-30 15:15:30.027137] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 15:15:00.006262+05:30] Nifty Spot: 25938.05
[2025-12-30 15:15:31.127648] Fetching quotes for 22 options...
[2025-12-30 15:15:31.159070] ‚úì Retrieved 22 option quotes
[2025-12-30 15:15:00.006262+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 15:15:00.006262+05:30] PUT 25900.0: OI=35,434,275, Change=-6,322,575 (-15.14%) - UNWINDING ‚úì
[2025-12-30 15:15:00.006262+05:30] PUT 25900.0: Price=‚Çπ0.05, VWAP=‚Çπ1.45 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:15:31] Waiting 269s for next candle at 15:20:00

================================================================================
[2025-12-30 15:20:00.006274+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 15:20:22.576364] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 15:20:22.576440] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 15:20:00.006274+05:30] Nifty Spot: 25940.20
[2025-12-30 15:20:23.663666] Fetching quotes for 22 options...
[2025-12-30 15:20:23.747384] ‚úì Retrieved 22 option quotes
[2025-12-30 15:20:00.006274+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 15:20:00.006274+05:30] PUT 25900.0: OI=31,933,575, Change=-9,823,275 (-23.52%) - UNWINDING ‚úì
[2025-12-30 15:20:00.006274+05:30] PUT 25900.0: Price=‚Çπ0.10, VWAP=‚Çπ1.30 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:20:23] Waiting 276s for next candle at 15:25:00
