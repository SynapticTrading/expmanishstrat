/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2025-12-29 14:57:17.312078+05:30] Checking for previous session...
[2025-12-29 14:57:17.312248+05:30] ‚úì State loaded from paper_trading/state/trading_state_20251229.json
[2025-12-29 14:57:17.312268+05:30] Previous state found but no active positions - starting fresh

[2025-12-29 14:57:17.312276+05:30] Connecting to Zerodha...
[2025-12-29 14:57:17.312287] Connecting to Zerodha...
[2025-12-29 14:57:17.519662] Generated TOTP: 923114
[2025-12-29 14:57:17.635957] ‚úì Request token extracted from redirect
[2025-12-29 14:57:17.635985] Request token obtained: zbW33O47c5ZAP4tRpSIM...
[2025-12-29 14:57:17.703719] ‚úì Connection successful!
[2025-12-29 14:57:17.703738] Access Token: zPIfOKAtDC4EEcwn92eD...
[2025-12-29 14:57:17.703763] Zerodha data feed initialized
[2025-12-29 14:57:17.703770+05:30] ‚úì Connected to Zerodha

[2025-12-29 14:57:17.703791+05:30] Initializing new session...
[2025-12-29 14:57:17.706806+05:30] Session initialized: SESSION_20251229_1457
[2025-12-29 14:57:17.706827+05:30] State file: paper_trading/state/trading_state_20251229.json
[2025-12-29 14:57:17.706850+05:30] Loading instruments...
[2025-12-29 14:57:17.706864] Loading instruments...
[2025-12-29 14:57:17.706870] Fetching instruments for NFO...
[2025-12-29 14:57:18.906959] ‚úì Retrieved 38153 instruments
[2025-12-29 14:57:18.912016] Fetching instruments for NSE...
[2025-12-29 14:57:19.026699] ‚úì Retrieved 9078 instruments
[2025-12-29 14:57:19.029282] ‚úì Nifty 50 token: 256265
[2025-12-29 14:57:19.029301] ‚úì Instruments loaded
[2025-12-29 14:57:19.029313+05:30] Initializing paper broker...
[2025-12-29 14:57:19.029751] Paper Broker initialized with capital: ‚Çπ100,000.00
[2025-12-29 14:57:19.029764] Trade log: paper_trading/logs/trades_20251229_145719.csv
[2025-12-29 14:57:19.029777+05:30] Initializing OI analyzer...
[2025-12-29 14:57:19.030087+05:30] Initializing strategy...
[2025-12-29 14:57:19.030114] Strategy initialized
  Entry: 09:30:00 - 15:29:00
  Exit: 15:25:00 - 15:30:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2025-12-29 14:57:19.030346+05:30] ‚úì All components initialized

================================================================================
[2025-12-29 14:57:19.030360+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2025-12-29 14:57:19.030485+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2025-12-29 14:57:19.030518+05:30] ‚úì Exit monitor loop started
[2025-12-29 14:57:19.030688+05:30] ‚úì Strategy loop started

================================================================================
[2025-12-29 14:57:19.030698+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:57:19.030698+05:30] Nifty Spot: 25933.10
[2025-12-29 14:57:19.073721] Fetching quotes for 22 options...
[2025-12-29 14:57:19.126969] ‚úì Retrieved 22 option quotes

================================================================================
[2025-12-29 14:57:19.030698+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2025-12-29 14:57:19.030698+05:30] Determining direction using CURRENT OI data...
[2025-12-29 14:57:19.030698+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2025-12-29 14:57:19.030698+05:30] NEW TRADING DAY: 2025-12-29
================================================================================
[2025-12-29 14:57:19.030698+05:30] Max Call OI: 33,298,900 @ 26000.0, Max Put OI: 15,309,675 @ 26000.0
[2025-12-29 14:57:19.030698+05:30] Direction determined: PUT (Call dist: 66.90, Put dist: -66.90)
[2025-12-29 14:57:19.030698+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=25900.0, Expiry=2025-12-30, Spot=25933.10
[2025-12-29 14:57:19.030698+05:30] üîÑ Reset VWAP running totals for new day: 2025-12-29
[2025-12-29 14:57:19.030698+05:30] üéØ Initialized VWAP for PUT 25900.0: 69 bars from 9:15 AM
[2025-12-29 14:57:19.030698+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 14:57:19.030698+05:30] PUT 25900.0: OI=14,851,350, Change=0 (+0.00%) - BUILDING
[2025-12-29 14:57:19.030698+05:30] PUT 25900.0: Price=‚Çπ30.30, VWAP=‚Çπ30.30 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:57:19] Waiting 161s for next candle at 15:00:00

================================================================================
[2025-12-29 15:00:00.005241+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 15:00:00.005241+05:30] Nifty Spot: 25934.20
[2025-12-29 15:00:00.051531] Fetching quotes for 22 options...
[2025-12-29 15:00:00.081821] ‚úì Retrieved 22 option quotes
[2025-12-29 15:00:00.005241+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 15:00:00.005241+05:30] PUT 25900.0: OI=14,838,750, Change=-12,600 (-0.08%) - UNWINDING ‚úì
[2025-12-29 15:00:00.005241+05:30] PUT 25900.0: Price=‚Çπ29.70, VWAP=‚Çπ30.00 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:00:00] Waiting 300s for next candle at 15:05:00

================================================================================
[2025-12-29 15:05:00.021453+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 15:05:30.035420] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-29 15:05:30.035460] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 15:05:00.021453+05:30] Nifty Spot: 25944.25
[2025-12-29 15:05:31.113677] Fetching quotes for 22 options...
[2025-12-29 15:05:31.159577] ‚úì Retrieved 22 option quotes
[2025-12-29 15:05:00.021453+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 15:05:00.021453+05:30] PUT 25900.0: OI=15,328,725, Change=477,375 (+3.21%) - BUILDING
[2025-12-29 15:05:00.021453+05:30] PUT 25900.0: Price=‚Çπ26.35, VWAP=‚Çπ28.75 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:05:31] Waiting 269s for next candle at 15:10:00

================================================================================
[2025-12-29 15:10:00.006179+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 15:10:30.013097] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-29 15:10:30.013142] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 15:10:00.006179+05:30] Nifty Spot: 25947.40
[2025-12-29 15:10:31.093440] Fetching quotes for 22 options...
[2025-12-29 15:10:31.132619] ‚úì Retrieved 22 option quotes
[2025-12-29 15:10:00.006179+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 15:10:00.006179+05:30] PUT 25900.0: OI=14,578,650, Change=-272,700 (-1.84%) - UNWINDING ‚úì
[2025-12-29 15:10:00.006179+05:30] PUT 25900.0: Price=‚Çπ27.45, VWAP=‚Çπ28.42 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:10:31] Waiting 269s for next candle at 15:15:00

================================================================================
[2025-12-29 15:15:00.007647+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 15:15:28.578137] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-29 15:15:28.578221] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 15:15:00.007647+05:30] Nifty Spot: 25939.45
[2025-12-29 15:15:29.658779] Fetching quotes for 22 options...
[2025-12-29 15:15:29.695338] ‚úì Retrieved 22 option quotes
[2025-12-29 15:15:00.007647+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 15:15:00.007647+05:30] PUT 25900.0: OI=14,128,050, Change=-723,300 (-4.87%) - UNWINDING ‚úì
[2025-12-29 15:15:00.007647+05:30] PUT 25900.0: Price=‚Çπ28.20, VWAP=‚Çπ28.37 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:15:29] Waiting 270s for next candle at 15:20:00

================================================================================
[2025-12-29 15:20:00.006593+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 15:20:24.011798] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-29 15:20:24.011870] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 15:20:00.006593+05:30] Nifty Spot: 25942.85
[2025-12-29 15:20:25.082700] Fetching quotes for 22 options...
[2025-12-29 15:20:25.115725] ‚úì Retrieved 22 option quotes
[2025-12-29 15:20:00.006593+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 15:20:00.006593+05:30] PUT 25900.0: OI=13,690,650, Change=-1,160,700 (-7.82%) - UNWINDING ‚úì
[2025-12-29 15:20:00.006593+05:30] PUT 25900.0: Price=‚Çπ25.80, VWAP=‚Çπ27.93 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:20:25] Waiting 275s for next candle at 15:25:00

================================================================================
[2025-12-29 15:24:59.972161+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 15:25:21.861310] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-29 15:25:21.861380] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 15:24:59.972161+05:30] Nifty Spot: 25952.00
[2025-12-29 15:25:22.934889] Fetching quotes for 22 options...
[2025-12-29 15:25:22.969903] ‚úì Retrieved 22 option quotes
[2025-12-29 15:24:59.972161+05:30] üìç STRIKE UPDATED: 25900.0 ‚Üí 25950.0 (Spot: 25952.00)
[2025-12-29 15:24:59.972161+05:30] üéØ Initialized VWAP for PUT 25950.0: 74 bars from 9:15 AM
[2025-12-29 15:24:59.972161+05:30] Checking entry: PUT 25950.0, Expiry=2025-12-30
[2025-12-29 15:24:59.972161+05:30] PUT 25950.0: OI=9,026,100, Change=0 (+0.00%) - BUILDING
[2025-12-29 15:24:59.972161+05:30] PUT 25950.0: Price=‚Çπ43.60, VWAP=‚Çπ43.60 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25950.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:25:22] Waiting 277s for next candle at 15:30:00
[2025-12-29 15:30:00.004137+05:30] Market closed, stopping...

================================================================================
[2025-12-29 15:30:00.004302+05:30] Shutting down...
================================================================================

Final Statistics:
  Total Trades: 0
  Win Rate: 0.0%
  Total P&L: ‚Çπ0.00
  ROI: +0.00%
[2025-12-29 15:30:05.009620] Logging out...
[2025-12-29 15:30:30.002183] ‚úó Error during logout: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))

[2025-12-29 15:30:30.002236+05:30] ‚úì Shutdown complete
