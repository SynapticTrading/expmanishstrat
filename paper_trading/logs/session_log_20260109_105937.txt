================================================================================
   PAPER TRADING LAUNCHER
================================================================================
Starting paper trading...
Broker: zerodha
Log file: /Users/Algo_Trading/manishsir_options/paper_trading/logs/session_log_20260109_105937.txt
Press Ctrl+C to stop
================================================================================

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================
Loading configuration...
Loading credentials from: /Users/Algo_Trading/manishsir_options/paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2026-01-09 10:59:37.236363+05:30] Checking for previous session...
[2026-01-09 10:59:37.236543+05:30] No previous state found - starting fresh

[2026-01-09 10:59:37.236615+05:30] Connecting to Zerodha...
[2026-01-09 10:59:37.236691] Connecting to Zerodha...
[2026-01-09 10:59:37.419094] Generated TOTP: 885536
[2026-01-09 10:59:37.506711] ‚úì Request token extracted from redirect
[2026-01-09 10:59:37.506835] Request token obtained: GXAmsBGv9iLTLaJzFIuC...
[2026-01-09 10:59:37.573841] ‚úì Connection successful!
[2026-01-09 10:59:37.573965] Access Token: W9Lk3Em6Sw5arUuDao7K...
[2026-01-09 10:59:37.574020] Zerodha data feed initialized
[2026-01-09 10:59:37.574053+05:30] ‚úì Connected to Zerodha

[2026-01-09 10:59:37.574098+05:30] Initializing new session...
[2026-01-09 10:59:37.574404+05:30] üÜï First session - Starting with ‚Çπ100,000.00
[2026-01-09 10:59:37.574896+05:30] Session initialized: SESSION_20260109_1059
[2026-01-09 10:59:37.574939+05:30] State file: paper_trading/state/trading_state_zerodha_20260109.json
[2026-01-09 10:59:37.574980+05:30] Loading instruments...
[2026-01-09 10:59:37.575008] Loading instruments...
[2026-01-09 10:59:37.575033] Fetching instruments for NFO...
[2026-01-09 10:59:38.700944] ‚úì Retrieved 40424 instruments
[2026-01-09 10:59:38.706568] Fetching instruments for NSE...
[2026-01-09 10:59:38.817076] ‚úì Retrieved 9108 instruments
[2026-01-09 10:59:38.819477] ‚úì Nifty 50 token: 256265
[2026-01-09 10:59:38.819550] ‚úì Instruments loaded
[2026-01-09 10:59:38.819584+05:30] Initializing paper broker...
[2026-01-09 10:59:38.820035] Paper Broker initialized with capital: ‚Çπ100,000.00
[2026-01-09 10:59:38.820077] Daily trade log: paper_trading/logs/trades_20260109_105938.csv
[2026-01-09 10:59:38.820104] Cumulative trade log: paper_trading/logs/trades_cumulative.csv
[2026-01-09 10:59:38.820131+05:30] Initializing OI analyzer...
[2026-01-09 10:59:38.820452+05:30] Initializing strategy...
[2026-01-09 10:59:38.820507] Strategy initialized
  Entry: 09:30:00 - 15:28:00
  Exit: 15:29:00 - 15:30:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2026-01-09 10:59:38.820925+05:30] ‚úì All components initialized

================================================================================
[2026-01-09 10:59:38.820984+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================
[2026-01-09 10:59:38.821174+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2026-01-09 10:59:38.821234+05:30] ‚úì Exit monitor loop started
[2026-01-09 10:59:38.821471+05:30] ‚úì Strategy loop started

================================================================================
[2026-01-09 10:59:38.821506+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================
[2026-01-09 10:59:38.821506+05:30] Nifty Spot: 25820.00
[2026-01-09 10:59:38.861287] Fetching quotes for 22 options...
[2026-01-09 10:59:38.903474] ‚úì Retrieved 22 option quotes

================================================================================
[2026-01-09 10:59:38.821506+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2026-01-09 10:59:38.821506+05:30] Determining direction using CURRENT OI data...
[2026-01-09 10:59:38.821506+05:30] (OI buildup direction is still valid mid-day)
================================================================================

================================================================================
[2026-01-09 10:59:38.821506+05:30] NEW TRADING DAY: 2026-01-09
================================================================================

================================================================================
OI DISTRIBUTION DEBUG (Spot: 25820.00)
================================================================================

CALL OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
25550.0             49,075            -270.00
25600.0            447,785            -220.00
25650.0            169,585            -170.00
25700.0          1,430,000            -120.00
25750.0          1,004,770             -70.00
25800.0          5,544,890             -20.00
25850.0          7,174,765              30.00
25900.0         16,754,075              80.00
25950.0         10,489,765             130.00
26000.0         21,190,845             180.00 üëà MAX
26050.0          9,549,475             230.00

PUT OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
25550.0          3,427,450             270.00
25600.0          9,630,335             220.00
25650.0          4,798,365             170.00
25700.0         12,070,240             120.00
25750.0          6,351,930              70.00
25800.0         17,560,790              20.00 üëà MAX
25850.0         11,129,820             -30.00
25900.0         14,032,590             -80.00
25950.0          4,490,525            -130.00
26000.0          6,084,910            -180.00
26050.0          1,662,830            -230.00
================================================================================
[2026-01-09 10:59:38.821506+05:30] Max Call OI: 21,190,845 @ 26000.0, Max Put OI: 17,560,790 @ 25800.0
[2026-01-09 10:59:38.821506+05:30] Direction determined: PUT (Call dist: 180.00, Put dist: 20.00)
[2026-01-09 10:59:38.821506+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=25800.0, Expiry=2026-01-13, Spot=25820.00
[2026-01-09 10:59:38.821506+05:30] üîÑ Reset VWAP running totals for new day: 2026-01-09
[2026-01-09 10:59:38.821506+05:30] üéØ Initialized VWAP for PUT 25800.0: 21 bars from 9:15 AM
[2026-01-09 10:59:38.821506+05:30] Checking entry: PUT 25800.0, Expiry=2026-01-13
[2026-01-09 10:59:38.821506+05:30] PUT 25800.0: OI=17,560,790, Change=0 (+0.00%) - BUILDING
[2026-01-09 10:59:38.821506+05:30] PUT 25800.0: Price=‚Çπ64.10, VWAP=‚Çπ64.10 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-09
Broker: Zerodha
Daily Direction: PUT @ 25800.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------
[10:59:38] Waiting 21s for next candle at 11:00:00

================================================================================
[2026-01-09 11:00:00.006183+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================
[2026-01-09 11:00:00.006183+05:30] Nifty Spot: 25821.50
[2026-01-09 11:00:00.064282] Fetching quotes for 22 options...
[2026-01-09 11:00:00.105188] ‚úì Retrieved 22 option quotes
[2026-01-09 11:00:00.006183+05:30] Checking entry: PUT 25800.0, Expiry=2026-01-13
[2026-01-09 11:00:00.006183+05:30] PUT 25800.0: OI=17,560,790, Change=0 (+0.00%) - BUILDING
[2026-01-09 11:00:00.006183+05:30] PUT 25800.0: Price=‚Çπ64.25, VWAP=‚Çπ64.18 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-09
Broker: Zerodha
Daily Direction: PUT @ 25800.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------
[11:00:00] Waiting 300s for next candle at 11:05:00

================================================================================
[2026-01-09 11:05:00.005261+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================
[2026-01-09 11:05:30.024336] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2026-01-09 11:05:30.024594] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-09 11:05:00.005261+05:30] Nifty Spot: 25813.15
[2026-01-09 11:05:31.123187] Fetching quotes for 22 options...
[2026-01-09 11:05:31.154635] ‚úì Retrieved 22 option quotes
[2026-01-09 11:05:00.005261+05:30] Checking entry: PUT 25800.0, Expiry=2026-01-13
[2026-01-09 11:05:00.005261+05:30] PUT 25800.0: OI=17,839,510, Change=278,720 (+1.59%) - BUILDING
[2026-01-09 11:05:00.005261+05:30] PUT 25800.0: Price=‚Çπ67.20, VWAP=‚Çπ65.22 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-09
Broker: Zerodha
Daily Direction: PUT @ 25800.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------
[11:05:31] Waiting 269s for next candle at 11:10:00

================================================================================
[2026-01-09 11:10:00.005016+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================
[2026-01-09 11:10:27.040899] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-09 11:10:27.041260] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-09 11:10:00.005016+05:30] Nifty Spot: 25822.30
[2026-01-09 11:10:28.118362] Fetching quotes for 22 options...
[2026-01-09 11:10:28.161065] ‚úì Retrieved 22 option quotes
[2026-01-09 11:10:00.005016+05:30] Checking entry: PUT 25800.0, Expiry=2026-01-13
[2026-01-09 11:10:00.005016+05:30] PUT 25800.0: OI=17,886,765, Change=325,975 (+1.86%) - BUILDING
[2026-01-09 11:10:00.005016+05:30] PUT 25800.0: Price=‚Çπ62.80, VWAP=‚Çπ64.58 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-09
Broker: Zerodha
Daily Direction: PUT @ 25800.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------
[11:10:28] Waiting 272s for next candle at 11:15:00
