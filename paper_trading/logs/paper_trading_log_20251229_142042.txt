/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2025-12-29 14:20:43.648753+05:30] Checking for previous session...
[2025-12-29 14:20:43.648902+05:30] ‚úì State loaded from paper_trading/state/trading_state_20251229.json
[2025-12-29 14:20:43.648921+05:30] Previous state found but no active positions - starting fresh

[2025-12-29 14:20:43.648929+05:30] Connecting to Zerodha...
[2025-12-29 14:20:43.648938] Connecting to Zerodha...
[2025-12-29 14:20:43.824268] Generated TOTP: 245454
[2025-12-29 14:20:43.953592] ‚úì Request token extracted from redirect
[2025-12-29 14:20:43.953636] Request token obtained: sBxg3No9O2xAyg41ADRR...
[2025-12-29 14:20:44.029982] ‚úì Connection successful!
[2025-12-29 14:20:44.029995] Access Token: zPIfOKAtDC4EEcwn92eD...
[2025-12-29 14:20:44.030015] Zerodha data feed initialized
[2025-12-29 14:20:44.030021+05:30] ‚úì Connected to Zerodha

[2025-12-29 14:20:44.030036+05:30] Initializing new session...
[2025-12-29 14:20:44.032654+05:30] Session initialized: SESSION_20251229_1420
[2025-12-29 14:20:44.032676+05:30] State file: paper_trading/state/trading_state_20251229.json
[2025-12-29 14:20:44.032698+05:30] Loading instruments...
[2025-12-29 14:20:44.032711] Loading instruments...
[2025-12-29 14:20:44.032716] Fetching instruments for NFO...
[2025-12-29 14:20:46.448308] ‚úì Retrieved 38153 instruments
[2025-12-29 14:20:46.453239] Fetching instruments for NSE...
[2025-12-29 14:20:46.641940] ‚úì Retrieved 9078 instruments
[2025-12-29 14:20:46.644160] ‚úì Nifty 50 token: 256265
[2025-12-29 14:20:46.644175] ‚úì Instruments loaded
[2025-12-29 14:20:46.644182+05:30] Initializing paper broker...
[2025-12-29 14:20:46.644643] Paper Broker initialized with capital: ‚Çπ100,000.00
[2025-12-29 14:20:46.644655] Trade log: paper_trading/logs/trades_20251229_142046.csv
[2025-12-29 14:20:46.644666+05:30] Initializing OI analyzer...
[2025-12-29 14:20:46.644982+05:30] Initializing strategy...
[2025-12-29 14:20:46.645008] Strategy initialized
  Entry: 09:30:00 - 14:30:00
  Exit: 14:50:00 - 15:00:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2025-12-29 14:20:46.645263+05:30] ‚úì All components initialized

================================================================================
[2025-12-29 14:20:46.645277+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2025-12-29 14:20:46.645388+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2025-12-29 14:20:46.645427+05:30] ‚úì Exit monitor loop started
[2025-12-29 14:20:46.645670+05:30] ‚úì Strategy loop started

================================================================================
[2025-12-29 14:20:46.645684+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:20:46.645684+05:30] Nifty Spot: 25928.70
[2025-12-29 14:20:46.687958] Fetching quotes for 22 options...
[2025-12-29 14:20:46.721331] ‚úì Retrieved 22 option quotes

================================================================================
[2025-12-29 14:20:46.645684+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2025-12-29 14:20:46.645684+05:30] Determining direction using CURRENT OI data...
[2025-12-29 14:20:46.645684+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2025-12-29 14:20:46.645684+05:30] NEW TRADING DAY: 2025-12-29
================================================================================
[2025-12-29 14:20:46.645684+05:30] Max Call OI: 33,880,475 @ 26000.0, Max Put OI: 16,555,875 @ 25900.0
[2025-12-29 14:20:46.645684+05:30] Direction determined: PUT (Call dist: 71.30, Put dist: 28.70)
[2025-12-29 14:20:46.645684+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=25900.0, Expiry=2025-12-30, Spot=25928.70
[2025-12-29 14:20:46.645684+05:30] üîÑ Reset VWAP running totals for new day: 2025-12-29
[2025-12-29 14:20:46.645684+05:30] üéØ Initialized VWAP for PUT 25900.0: 62 bars from 9:15 AM
[2025-12-29 14:20:46.645684+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 14:20:46.645684+05:30] PUT 25900.0: OI=16,555,875, Change=0 (+0.00%) - BUILDING
[2025-12-29 14:20:46.645684+05:30] PUT 25900.0: Price=‚Çπ33.05, VWAP=‚Çπ33.05 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:20:46] Waiting 253s for next candle at 14:25:00

================================================================================
[2025-12-29 14:25:00.005617+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:25:30.018642] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-29 14:25:30.018709] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 14:25:00.005617+05:30] Nifty Spot: 25957.85
[2025-12-29 14:25:31.097074] Fetching quotes for 22 options...
[2025-12-29 14:25:31.130169] ‚úì Retrieved 22 option quotes
[2025-12-29 14:25:00.005617+05:30] üìç STRIKE UPDATED: 25900.0 ‚Üí 25950.0 (Spot: 25957.85)
[2025-12-29 14:25:00.005617+05:30] üéØ Initialized VWAP for PUT 25950.0: 63 bars from 9:15 AM
[2025-12-29 14:25:00.005617+05:30] Checking entry: PUT 25950.0, Expiry=2025-12-30
[2025-12-29 14:25:00.005617+05:30] PUT 25950.0: OI=10,605,900, Change=0 (+0.00%) - BUILDING
[2025-12-29 14:25:00.005617+05:30] PUT 25950.0: Price=‚Çπ42.95, VWAP=‚Çπ42.95 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25950.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:25:31] Waiting 269s for next candle at 14:30:00

================================================================================
[2025-12-29 14:30:00.002631+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:30:23.968525] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-29 14:30:23.968570] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 14:30:00.002631+05:30] Nifty Spot: 25950.80
[2025-12-29 14:30:25.042702] Fetching quotes for 22 options...
[2025-12-29 14:30:25.082795] ‚úì Retrieved 22 option quotes

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25950.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:30:25] Waiting 275s for next candle at 14:35:00

================================================================================
[2025-12-29 14:35:00.004991+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:35:27.047554] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-29 14:35:27.047582] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 14:35:00.004991+05:30] Nifty Spot: 25954.50
[2025-12-29 14:35:28.117099] Fetching quotes for 22 options...
[2025-12-29 14:35:28.151127] ‚úì Retrieved 22 option quotes

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25950.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:35:28] Waiting 272s for next candle at 14:40:00
