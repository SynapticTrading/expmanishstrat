/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2026-01-01 12:08:35.364114+05:30] Checking for previous session...
[2026-01-01 12:08:35.364205+05:30] No previous state found - starting fresh

[2026-01-01 12:08:35.364216+05:30] Connecting to Zerodha...
[2026-01-01 12:08:35.364226] Connecting to Zerodha...
[2026-01-01 12:08:35.561815] Generated TOTP: 332884
[2026-01-01 12:08:35.647289] ‚úì Request token extracted from redirect
[2026-01-01 12:08:35.647312] Request token obtained: VEHVL8QznlXz2Lk7FAoa...
[2026-01-01 12:08:35.733613] ‚úì Connection successful!
[2026-01-01 12:08:35.733633] Access Token: IHHBzO28bEmEsAxe41LO...
[2026-01-01 12:08:35.733656] Zerodha data feed initialized
[2026-01-01 12:08:35.733665+05:30] ‚úì Connected to Zerodha

[2026-01-01 12:08:35.733687+05:30] Initializing new session...
[2026-01-01 12:08:35.734138+05:30] üìä PORTFOLIO CARRYOVER
  Previous Date: 2025-12-31
  Starting Capital: ‚Çπ106,547.50
  Previous P&L: ‚Çπ+6,420.00
  Previous Trades: 1
  Previous Win Rate: 100.0%
[2026-01-01 12:08:35.734629+05:30] Session initialized: SESSION_20260101_1208
[2026-01-01 12:08:35.734640+05:30] State file: paper_trading/state/trading_state_20260101.json
[2026-01-01 12:08:35.734659+05:30] Loading instruments...
[2026-01-01 12:08:35.734668] Loading instruments...
[2026-01-01 12:08:35.734679] Fetching instruments for NFO...
[2026-01-01 12:08:36.732987] ‚úì Retrieved 35147 instruments
[2026-01-01 12:08:36.738038] Fetching instruments for NSE...
[2026-01-01 12:08:36.851683] ‚úì Retrieved 9060 instruments
[2026-01-01 12:08:36.854978] ‚úì Nifty 50 token: 256265
[2026-01-01 12:08:36.854996] ‚úì Instruments loaded
[2026-01-01 12:08:36.855006+05:30] Initializing paper broker...
[2026-01-01 12:08:36.855619] Paper Broker initialized with capital: ‚Çπ106,547.50
[2026-01-01 12:08:36.855634] Daily trade log: paper_trading/logs/trades_20260101_120836.csv
[2026-01-01 12:08:36.855638] Cumulative trade log: paper_trading/logs/trades_cumulative.csv
[2026-01-01 12:08:36.855650+05:30] Initializing OI analyzer...
[2026-01-01 12:08:36.856002+05:30] Initializing strategy...
[2026-01-01 12:08:36.856036] Strategy initialized
  Entry: 09:30:00 - 14:30:00
  Exit: 14:50:00 - 15:00:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2026-01-01 12:08:36.856355+05:30] ‚úì All components initialized

================================================================================
[2026-01-01 12:08:36.856370+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2026-01-01 12:08:36.856521+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2026-01-01 12:08:36.856561+05:30] ‚úì Exit monitor loop started
[2026-01-01 12:08:36.856787+05:30] ‚úì Strategy loop started

================================================================================
[2026-01-01 12:08:36.856797+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-01 12:08:36.856797+05:30] Nifty Spot: 26133.50
[2026-01-01 12:08:36.895233] Fetching quotes for 22 options...
[2026-01-01 12:08:36.943476] ‚úì Retrieved 22 option quotes

================================================================================
[2026-01-01 12:08:36.856797+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2026-01-01 12:08:36.856797+05:30] Determining direction using CURRENT OI data...
[2026-01-01 12:08:36.856797+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2026-01-01 12:08:36.856797+05:30] NEW TRADING DAY: 2026-01-01
================================================================================

================================================================================
OI DISTRIBUTION DEBUG (Spot: 26133.50)
================================================================================

CALL OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
25900.0          1,081,275            -233.50
25950.0            659,555            -183.50
26000.0          4,617,925            -133.50
26050.0          1,735,240             -83.50
26100.0          6,807,255             -33.50
26150.0          7,969,585              16.50
26200.0         15,185,300              66.50 üëà MAX
26250.0          6,467,435             116.50
26300.0         10,023,910             166.50
26350.0          4,369,820             216.50
26400.0          8,962,395             266.50

PUT OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
25900.0          8,690,435             233.50
25950.0          5,794,425             183.50
26000.0         16,075,150             133.50 üëà MAX
26050.0          7,195,175              83.50
26100.0         11,509,095              33.50
26150.0          7,556,965             -16.50
26200.0          8,150,090             -66.50
26250.0          2,065,505            -116.50
26300.0          2,451,085            -166.50
26350.0            525,850            -216.50
26400.0            687,440            -266.50
================================================================================

[2026-01-01 12:08:36.856797+05:30] Max Call OI: 15,185,300 @ 26200.0, Max Put OI: 16,075,150 @ 26000.0
[2026-01-01 12:08:36.856797+05:30] Direction determined: CALL (Call dist: 66.50, Put dist: 133.50)
[2026-01-01 12:08:36.856797+05:30] ‚úì Daily Analysis Complete: Direction=CALL, Strike=26150.0, Expiry=2026-01-06, Spot=26133.50
[2026-01-01 12:08:36.856797+05:30] üîÑ Reset VWAP running totals for new day: 2026-01-01
[2026-01-01 12:08:36.856797+05:30] üéØ Initialized VWAP for CALL 26150.0: 35 bars from 9:15 AM
[2026-01-01 12:08:36.856797+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2026-01-01 12:08:36.856797+05:30] CALL 26150.0: OI=7,969,585, Change=0 (+0.00%) - BUILDING
[2026-01-01 12:08:36.856797+05:30] CALL 26150.0: Price=‚Çπ86.50, VWAP=‚Çπ86.50 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-01
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[12:08:36] Waiting 83s for next candle at 12:10:00

================================================================================
[2026-01-01 12:10:00.000745+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-01 12:10:00.000745+05:30] Nifty Spot: 26130.85
[2026-01-01 12:10:00.070787] Fetching quotes for 22 options...
[2026-01-01 12:10:00.113201] ‚úì Retrieved 22 option quotes
[2026-01-01 12:10:00.000745+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2026-01-01 12:10:00.000745+05:30] CALL 26150.0: OI=7,969,585, Change=0 (+0.00%) - BUILDING
[2026-01-01 12:10:00.000745+05:30] CALL 26150.0: Price=‚Çπ86.10, VWAP=‚Çπ86.30 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-01
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[12:10:00] Waiting 300s for next candle at 12:15:00

================================================================================
[2026-01-01 12:15:00.030804+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-01 12:15:30.052017] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2026-01-01 12:15:30.052067] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-01 12:15:00.030804+05:30] Nifty Spot: 26120.45
[2026-01-01 12:15:31.181189] Fetching quotes for 22 options...
[2026-01-01 12:15:31.222523] ‚úì Retrieved 22 option quotes
[2026-01-01 12:15:00.030804+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2026-01-01 12:15:00.030804+05:30] CALL 26150.0: OI=8,239,920, Change=270,335 (+3.39%) - BUILDING
[2026-01-01 12:15:00.030804+05:30] CALL 26150.0: Price=‚Çπ83.10, VWAP=‚Çπ85.21 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-01
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[12:15:31] Waiting 269s for next candle at 12:20:00

================================================================================
[2026-01-01 12:20:00.006693+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-01 12:20:30.014240] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2026-01-01 12:20:30.014301] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-01 12:20:00.006693+05:30] Nifty Spot: 26131.20
[2026-01-01 12:20:31.136894] Fetching quotes for 22 options...
[2026-01-01 12:20:31.202162] ‚úì Retrieved 22 option quotes
[2026-01-01 12:20:00.006693+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2026-01-01 12:20:00.006693+05:30] CALL 26150.0: OI=8,465,405, Change=495,820 (+6.22%) - BUILDING
[2026-01-01 12:20:00.006693+05:30] CALL 26150.0: Price=‚Çπ86.65, VWAP=‚Çπ85.59 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-01
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[12:20:31] Waiting 269s for next candle at 12:25:00

================================================================================
[2026-01-01 12:25:00.006630+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-01 12:25:30.044118] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2026-01-01 12:25:30.044183] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-01 12:25:00.006630+05:30] Nifty Spot: 26139.30
[2026-01-01 12:25:31.134112] Fetching quotes for 22 options...
[2026-01-01 12:25:31.168135] ‚úì Retrieved 22 option quotes
[2026-01-01 12:25:00.006630+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2026-01-01 12:25:00.006630+05:30] CALL 26150.0: OI=8,578,700, Change=609,115 (+7.64%) - BUILDING
[2026-01-01 12:25:00.006630+05:30] CALL 26150.0: Price=‚Çπ87.85, VWAP=‚Çπ86.06 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-01
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[12:25:31] Waiting 269s for next candle at 12:30:00

================================================================================
[2026-01-01 12:30:00.004133+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-01 12:30:26.049328] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-01 12:30:26.049415] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-01 12:30:00.004133+05:30] Nifty Spot: 26145.30
[2026-01-01 12:30:27.135864] Fetching quotes for 22 options...
[2026-01-01 12:30:27.176818] ‚úì Retrieved 22 option quotes
[2026-01-01 12:30:00.004133+05:30] Checking entry: CALL 26150.0, Expiry=2026-01-06
[2026-01-01 12:30:00.004133+05:30] CALL 26150.0: OI=8,515,650, Change=546,065 (+6.85%) - BUILDING
[2026-01-01 12:30:00.004133+05:30] CALL 26150.0: Price=‚Çπ89.80, VWAP=‚Çπ86.72 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-01
Broker: Zerodha
Daily Direction: CALL @ 26150.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[12:30:27] Waiting 273s for next candle at 12:35:00

================================================================================
[2026-01-01 12:35:00.006647+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-01 12:35:25.083015] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-01 12:35:25.083082] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-01 12:35:00.006647+05:30] Nifty Spot: 26154.40
[2026-01-01 12:35:26.347240] Fetching quotes for 22 options...
[2026-01-01 12:35:26.401423] ‚úì Retrieved 22 option quotes
[2026-01-01 12:35:00.006647+05:30] üìç STRIKE UPDATED: 26150.0 ‚Üí 26200.0 (Spot: 26154.40)
[2026-01-01 12:35:00.006647+05:30] üéØ Initialized VWAP for CALL 26200.0: 41 bars from 9:15 AM
[2026-01-01 12:35:00.006647+05:30] Checking entry: CALL 26200.0, Expiry=2026-01-06
[2026-01-01 12:35:00.006647+05:30] CALL 26200.0: OI=15,392,000, Change=0 (+0.00%) - BUILDING
[2026-01-01 12:35:00.006647+05:30] CALL 26200.0: Price=‚Çπ67.00, VWAP=‚Çπ67.00 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-01
Broker: Zerodha
Daily Direction: CALL @ 26200.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[12:35:26] Waiting 274s for next candle at 12:40:00
