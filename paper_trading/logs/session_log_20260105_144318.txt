/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2026-01-05 14:43:19.432136+05:30] Checking for previous session...
[2026-01-05 14:43:19.432223+05:30] No previous state found - starting fresh

[2026-01-05 14:43:19.432235+05:30] Connecting to Zerodha...
[2026-01-05 14:43:19.432249] Connecting to Zerodha...
[2026-01-05 14:43:19.617739] Generated TOTP: 181266
[2026-01-05 14:43:19.715105] ‚úì Request token extracted from redirect
[2026-01-05 14:43:19.715129] Request token obtained: ukv79twHjqLUithyWq8B...
[2026-01-05 14:43:19.784067] ‚úì Connection successful!
[2026-01-05 14:43:19.784081] Access Token: RdeeUH04AOYW5SIxyMAY...
[2026-01-05 14:43:19.784104] Zerodha data feed initialized
[2026-01-05 14:43:19.784111+05:30] ‚úì Connected to Zerodha

[2026-01-05 14:43:19.784130+05:30] Initializing new session...
[2026-01-05 14:43:19.789222+05:30] üìä PORTFOLIO CARRYOVER
  Previous Date: 2026-01-01
  Starting Capital: ‚Çπ106,161.25
  Previous P&L: ‚Çπ-386.25
  Previous Trades: 1
  Previous Win Rate: 0.0%
[2026-01-05 14:43:19.789646+05:30] Session initialized: SESSION_20260105_1443
[2026-01-05 14:43:19.789657+05:30] State file: paper_trading/state/trading_state_20260105.json
[2026-01-05 14:43:19.789676+05:30] Loading instruments...
[2026-01-05 14:43:19.789684] Loading instruments...
[2026-01-05 14:43:19.789690] Fetching instruments for NFO...
[2026-01-05 14:43:20.855814] ‚úì Retrieved 37479 instruments
[2026-01-05 14:43:20.862208] Fetching instruments for NSE...
[2026-01-05 14:43:20.963738] ‚úì Retrieved 9107 instruments
[2026-01-05 14:43:20.967238] ‚úì Nifty 50 token: 256265
[2026-01-05 14:43:20.967261] ‚úì Instruments loaded
[2026-01-05 14:43:20.967270+05:30] Initializing paper broker...
[2026-01-05 14:43:20.967907] Paper Broker initialized with capital: ‚Çπ106,161.25
[2026-01-05 14:43:20.967924] Daily trade log: paper_trading/logs/trades_20260105_144320.csv
[2026-01-05 14:43:20.967929] Cumulative trade log: paper_trading/logs/trades_cumulative.csv
[2026-01-05 14:43:20.967940+05:30] Initializing OI analyzer...
[2026-01-05 14:43:20.968308+05:30] Initializing strategy...
[2026-01-05 14:43:20.968343] Strategy initialized
  Entry: 09:30:00 - 15:28:00
  Exit: 15:29:00 - 15:30:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2026-01-05 14:43:20.968732+05:30] ‚úì All components initialized

================================================================================
[2026-01-05 14:43:20.968800+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2026-01-05 14:43:20.969027+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2026-01-05 14:43:20.969062+05:30] ‚úì Exit monitor loop started
[2026-01-05 14:43:20.969302+05:30] ‚úì Strategy loop started

================================================================================
[2026-01-05 14:43:20.969312+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 14:43:20.969312+05:30] Nifty Spot: 26248.35
[2026-01-05 14:43:21.009851] Fetching quotes for 22 options...
[2026-01-05 14:43:21.049872] ‚úì Retrieved 22 option quotes

================================================================================
[2026-01-05 14:43:20.969312+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2026-01-05 14:43:20.969312+05:30] Determining direction using CURRENT OI data...
[2026-01-05 14:43:20.969312+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2026-01-05 14:43:20.969312+05:30] NEW TRADING DAY: 2026-01-05
================================================================================

================================================================================
OI DISTRIBUTION DEBUG (Spot: 26248.35)
================================================================================

CALL OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
26000.0          2,808,260            -248.35
26050.0            684,970            -198.35
26100.0          2,893,410            -148.35
26150.0          2,640,040             -98.35
26200.0         13,473,655             -48.35
26250.0         19,735,625               1.65
26300.0         29,041,480              51.65 üëà MAX
26350.0         18,885,165             101.65
26400.0         21,080,605             151.65
26450.0          8,702,005             201.65
26500.0         17,027,205             251.65

PUT OI by Strike:
Strike                  OI   Distance from Spot
--------------------------------------------------
26000.0         18,349,500             248.35
26050.0          7,060,105             198.35
26100.0         14,233,180             148.35
26150.0         12,416,040              98.35
26200.0         24,100,375              48.35 üëà MAX
26250.0         11,856,000              -1.65
26300.0         10,244,065             -51.65
26350.0          3,495,700            -101.65
26400.0          2,419,365            -151.65
26450.0            535,600            -201.65
26500.0          1,155,310            -251.65
================================================================================

[2026-01-05 14:43:20.969312+05:30] Max Call OI: 29,041,480 @ 26300.0, Max Put OI: 24,100,375 @ 26200.0
[2026-01-05 14:43:20.969312+05:30] Direction determined: PUT (Call dist: 51.65, Put dist: 48.35)
[2026-01-05 14:43:20.969312+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=26200.0, Expiry=2026-01-06, Spot=26248.35
[2026-01-05 14:43:20.969312+05:30] üîÑ Reset VWAP running totals for new day: 2026-01-05
[2026-01-05 14:43:20.969312+05:30] üéØ Initialized VWAP for PUT 26200.0: 66 bars from 9:15 AM
[2026-01-05 14:43:20.969312+05:30] Checking entry: PUT 26200.0, Expiry=2026-01-06
[2026-01-05 14:43:20.969312+05:30] PUT 26200.0: OI=24,100,375, Change=0 (+0.00%) - BUILDING
[2026-01-05 14:43:20.969312+05:30] PUT 26200.0: Price=‚Çπ36.45, VWAP=‚Çπ36.45 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26200.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:43:21] Waiting 99s for next candle at 14:45:00

================================================================================
[2026-01-05 14:45:00.005749+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 14:45:00.005749+05:30] Nifty Spot: 26257.15
[2026-01-05 14:45:00.090788] Fetching quotes for 22 options...
[2026-01-05 14:45:00.129027] ‚úì Retrieved 22 option quotes
[2026-01-05 14:45:00.005749+05:30] üìç STRIKE UPDATED: 26200.0 ‚Üí 26250.0 (Spot: 26257.15)
[2026-01-05 14:45:00.005749+05:30] üéØ Initialized VWAP for PUT 26250.0: 67 bars from 9:15 AM
[2026-01-05 14:45:00.005749+05:30] Checking entry: PUT 26250.0, Expiry=2026-01-06
[2026-01-05 14:45:00.005749+05:30] PUT 26250.0: OI=12,068,680, Change=0 (+0.00%) - BUILDING
[2026-01-05 14:45:00.005749+05:30] PUT 26250.0: Price=‚Çπ55.90, VWAP=‚Çπ55.90 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26250.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:45:00] Waiting 300s for next candle at 14:50:00

================================================================================
[2026-01-05 14:50:00.007082+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 14:50:30.021362] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2026-01-05 14:50:30.021423] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-05 14:50:00.007082+05:30] Nifty Spot: 26259.90
[2026-01-05 14:50:31.112563] Fetching quotes for 22 options...
[2026-01-05 14:50:31.149053] ‚úì Retrieved 22 option quotes
[2026-01-05 14:50:00.007082+05:30] Checking entry: PUT 26250.0, Expiry=2026-01-06
[2026-01-05 14:50:00.007082+05:30] PUT 26250.0: OI=12,573,275, Change=504,595 (+4.18%) - BUILDING
[2026-01-05 14:50:00.007082+05:30] PUT 26250.0: Price=‚Çπ56.75, VWAP=‚Çπ56.33 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26250.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:50:31] Waiting 269s for next candle at 14:55:00

================================================================================
[2026-01-05 14:55:00.006864+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 14:55:29.616226] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-05 14:55:29.616269] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-05 14:55:00.006864+05:30] Nifty Spot: 26277.05
[2026-01-05 14:55:30.688484] Fetching quotes for 22 options...
[2026-01-05 14:55:30.719738] ‚úì Retrieved 22 option quotes
[2026-01-05 14:55:00.006864+05:30] Checking entry: PUT 26250.0, Expiry=2026-01-06
[2026-01-05 14:55:00.006864+05:30] PUT 26250.0: OI=13,401,635, Change=1,332,955 (+11.04%) - BUILDING
[2026-01-05 14:55:00.006864+05:30] PUT 26250.0: Price=‚Çπ49.50, VWAP=‚Çπ53.99 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26250.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:55:30] Waiting 269s for next candle at 15:00:00

================================================================================
[2026-01-05 15:00:00.011356+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 15:00:21.394830] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-05 15:00:21.394915] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-05 15:00:00.011356+05:30] Nifty Spot: 26280.10
[2026-01-05 15:00:22.477270] Fetching quotes for 22 options...
[2026-01-05 15:00:22.519965] ‚úì Retrieved 22 option quotes
[2026-01-05 15:00:00.011356+05:30] Checking entry: PUT 26250.0, Expiry=2026-01-06
[2026-01-05 15:00:00.011356+05:30] PUT 26250.0: OI=14,322,815, Change=2,254,135 (+18.68%) - BUILDING
[2026-01-05 15:00:00.011356+05:30] PUT 26250.0: Price=‚Çπ50.40, VWAP=‚Çπ53.07 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26250.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:00:22] Waiting 277s for next candle at 15:05:00

================================================================================
[2026-01-05 15:05:00.007220+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 15:05:28.153483] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-05 15:05:28.153556] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-05 15:05:00.007220+05:30] Nifty Spot: 26266.55
[2026-01-05 15:05:29.272569] Fetching quotes for 22 options...
[2026-01-05 15:05:29.317926] ‚úì Retrieved 22 option quotes
[2026-01-05 15:05:00.007220+05:30] Checking entry: PUT 26250.0, Expiry=2026-01-06
[2026-01-05 15:05:00.007220+05:30] PUT 26250.0: OI=13,661,050, Change=1,592,370 (+13.19%) - BUILDING
[2026-01-05 15:05:00.007220+05:30] PUT 26250.0: Price=‚Çπ56.00, VWAP=‚Çπ53.68 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26250.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:05:29] Waiting 271s for next candle at 15:10:00

================================================================================
[2026-01-05 15:10:00.012120+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 15:10:29.171939] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-05 15:10:29.172010] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-05 15:10:00.012120+05:30] Nifty Spot: 26254.30
[2026-01-05 15:10:30.285244] Fetching quotes for 22 options...
[2026-01-05 15:10:30.317437] ‚úì Retrieved 22 option quotes
[2026-01-05 15:10:00.012120+05:30] Checking entry: PUT 26250.0, Expiry=2026-01-06
[2026-01-05 15:10:00.012120+05:30] PUT 26250.0: OI=12,431,055, Change=362,375 (+3.00%) - BUILDING
[2026-01-05 15:10:00.012120+05:30] PUT 26250.0: Price=‚Çπ64.00, VWAP=‚Çπ55.50 - ABOVE ‚úì

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26250.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:10:30] Waiting 270s for next candle at 15:15:00

================================================================================
[2026-01-05 15:15:00.012112+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2026-01-05 15:15:26.517656] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2026-01-05 15:15:26.517728] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2026-01-05 15:15:00.012112+05:30] Nifty Spot: 26250.35
[2026-01-05 15:15:27.599349] Fetching quotes for 22 options...
[2026-01-05 15:15:27.630905] ‚úì Retrieved 22 option quotes
[2026-01-05 15:15:00.012112+05:30] Checking entry: PUT 26250.0, Expiry=2026-01-06
[2026-01-05 15:15:00.012112+05:30] PUT 26250.0: OI=10,933,845, Change=-1,134,835 (-9.40%) - UNWINDING ‚úì
[2026-01-05 15:15:00.012112+05:30] PUT 26250.0: Price=‚Çπ65.25, VWAP=‚Çπ56.99 - ABOVE ‚úì
[2026-01-05 15:15:00.012112+05:30] üéØ ENTRY SIGNAL: PUT 26250.0 - Price: 65.25, VWAP: 56.99, OI Change: -1,134,835 (-9.40%)
[2026-01-05 15:15:00.012112+05:30] üìà PLACING BUY ORDER: size=1, expected_price=65.25
[2026-01-05 15:15:27.633251] ‚úì BUY ORDER EXECUTED
  Strike: 26250.0 PUT
  Expiry: 2026-01-06
  Entry Price: ‚Çπ65.25
  Size: 75
  Cost: ‚Çπ4,893.75
  VWAP: ‚Çπ56.99
  OI: 10,933,845 (Change: -940.31%)
  Remaining Cash: ‚Çπ101,267.50
[2026-01-05 15:15:00.012112+05:30] üîµ BUY OPTION EXECUTED: PUT 26250.0 @ ‚Çπ65.25 (Expiry: 2026-01-06, 1 lot = 75 qty)
[2026-01-05 15:15:00.012112+05:30]    üìä ENTRY DATA: VWAP=56.99, OI=10,933,845, OI Change=-1,134,835 (-9.40%)

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2026-01-05
Broker: Zerodha
Daily Direction: PUT @ 26250.0
Open Positions: 1
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[15:15:27] Waiting 272s for next candle at 15:20:00
[2026-01-05 15:16:21.172207+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2026-01-05 15:16:21.230878] Fetching quotes for 22 options...
[2026-01-05 15:16:21.265218] ‚úì Retrieved 22 option quotes
[2026-01-05 15:16:21.172207+05:30] üìä LTP CHECK: 26250.0 PUT
    Current LTP: ‚Çπ65.55 | Entry: ‚Çπ65.25 | P&L: +0.46%
    Initial Stop: ‚Çπ48.94 (distance: 33.95%)
[2026-01-05 15:17:21.272132+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2026-01-05 15:17:21.320674] Fetching quotes for 22 options...
[2026-01-05 15:17:21.353029] ‚úì Retrieved 22 option quotes
[2026-01-05 15:17:21.272132+05:30] üìä LTP CHECK: 26250.0 PUT
    Current LTP: ‚Çπ64.30 | Entry: ‚Çπ65.25 | P&L: -1.46%
    Initial Stop: ‚Çπ48.94 (distance: 31.39%)
    VWAP Stop: ‚Çπ55.90 | Current VWAP: ‚Çπ58.85
    OI Change: +0.00% (Threshold: 10%)
[2026-01-05 15:18:21.359862+05:30] üîç Exit Monitor: Fetching real-time LTP for 1 position(s)...
[2026-01-05 15:18:21.440835] Fetching quotes for 22 options...
[2026-01-05 15:18:21.475656] ‚úì Retrieved 22 option quotes
[2026-01-05 15:18:21.359862+05:30] üìä LTP CHECK: 26250.0 PUT
    Current LTP: ‚Çπ65.30 | Entry: ‚Çπ65.25 | P&L: +0.08%
    Initial Stop: ‚Çπ48.94 (distance: 33.44%)
