/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2025-12-29 14:49:58.025948+05:30] Checking for previous session...
[2025-12-29 14:49:58.026111+05:30] ‚úì State loaded from paper_trading/state/trading_state_20251229.json
[2025-12-29 14:49:58.026130+05:30] Previous state found but no active positions - starting fresh

[2025-12-29 14:49:58.026139+05:30] Connecting to Zerodha...
[2025-12-29 14:49:58.026149] Connecting to Zerodha...
[2025-12-29 14:49:58.247823] Generated TOTP: 679125
[2025-12-29 14:49:58.329675] ‚úì Request token extracted from redirect
[2025-12-29 14:49:58.329699] Request token obtained: BD4Xj0Dk991odIxrXfQq...
[2025-12-29 14:49:58.425370] ‚úì Connection successful!
[2025-12-29 14:49:58.425385] Access Token: zPIfOKAtDC4EEcwn92eD...
[2025-12-29 14:49:58.425408] Zerodha data feed initialized
[2025-12-29 14:49:58.425414+05:30] ‚úì Connected to Zerodha

[2025-12-29 14:49:58.425430+05:30] Initializing new session...
[2025-12-29 14:49:58.425763+05:30] Session initialized: SESSION_20251229_1449
[2025-12-29 14:49:58.425776+05:30] State file: paper_trading/state/trading_state_20251229.json
[2025-12-29 14:49:58.425795+05:30] Loading instruments...
[2025-12-29 14:49:58.425805] Loading instruments...
[2025-12-29 14:49:58.425810] Fetching instruments for NFO...
[2025-12-29 14:49:59.833494] ‚úì Retrieved 38153 instruments
[2025-12-29 14:49:59.839574] Fetching instruments for NSE...
[2025-12-29 14:49:59.985209] ‚úì Retrieved 9078 instruments
[2025-12-29 14:49:59.988168] ‚úì Nifty 50 token: 256265
[2025-12-29 14:49:59.988186] ‚úì Instruments loaded
[2025-12-29 14:49:59.988195+05:30] Initializing paper broker...
[2025-12-29 14:49:59.988786] Paper Broker initialized with capital: ‚Çπ100,000.00
[2025-12-29 14:49:59.988800] Trade log: paper_trading/logs/trades_20251229_144959.csv
[2025-12-29 14:49:59.988811+05:30] Initializing OI analyzer...
[2025-12-29 14:49:59.989168+05:30] Initializing strategy...
[2025-12-29 14:49:59.989199] Strategy initialized
  Entry: 09:30:00 - 15:29:00
  Exit: 14:50:00 - 15:00:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2025-12-29 14:49:59.989480+05:30] ‚úì All components initialized

================================================================================
[2025-12-29 14:49:59.989496+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2025-12-29 14:49:59.989645+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2025-12-29 14:49:59.989681+05:30] ‚úì Exit monitor loop started
[2025-12-29 14:49:59.989911+05:30] ‚úì Strategy loop started

================================================================================
[2025-12-29 14:49:59.989923+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:49:59.989923+05:30] Nifty Spot: 25941.05
[2025-12-29 14:50:00.025122] Fetching quotes for 22 options...
[2025-12-29 14:50:00.055271] ‚úì Retrieved 22 option quotes

================================================================================
[2025-12-29 14:49:59.989923+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2025-12-29 14:49:59.989923+05:30] Determining direction using CURRENT OI data...
[2025-12-29 14:49:59.989923+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2025-12-29 14:49:59.989923+05:30] NEW TRADING DAY: 2025-12-29
================================================================================
[2025-12-29 14:49:59.989923+05:30] Max Call OI: 33,484,600 @ 26000.0, Max Put OI: 15,715,500 @ 25900.0
[2025-12-29 14:49:59.989923+05:30] Direction determined: PUT (Call dist: 58.95, Put dist: 41.05)
[2025-12-29 14:49:59.989923+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=25900.0, Expiry=2025-12-30, Spot=25941.05
[2025-12-29 14:49:59.989923+05:30] üîÑ Reset VWAP running totals for new day: 2025-12-29
[2025-12-29 14:49:59.989923+05:30] üéØ Initialized VWAP for PUT 25900.0: 67 bars from 9:15 AM
[2025-12-29 14:49:59.989923+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 14:49:59.989923+05:30] PUT 25900.0: OI=15,715,500, Change=0 (+0.00%) - BUILDING
[2025-12-29 14:49:59.989923+05:30] PUT 25900.0: Price=‚Çπ29.50, VWAP=‚Çπ29.50 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:50:00] Waiting 300s for next candle at 14:55:00

================================================================================
[2025-12-29 14:55:00.002859+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:55:26.053820] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-29 14:55:26.053890] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-29 14:55:00.002859+05:30] Nifty Spot: 25926.45
[2025-12-29 14:55:27.144796] Fetching quotes for 22 options...
[2025-12-29 14:55:27.180975] ‚úì Retrieved 22 option quotes
[2025-12-29 14:55:00.002859+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 14:55:00.002859+05:30] PUT 25900.0: OI=15,052,500, Change=-663,000 (-4.22%) - UNWINDING ‚úì
[2025-12-29 14:55:00.002859+05:30] PUT 25900.0: Price=‚Çπ33.35, VWAP=‚Çπ31.46 - ABOVE ‚úì
[2025-12-29 14:55:00.002859+05:30] üéØ ENTRY SIGNAL: PUT 25900.0 - Price: 33.35, VWAP: 31.46, OI Change: -663,000 (-4.22%)
[2025-12-29 14:55:00.002859+05:30] üìà PLACING BUY ORDER: size=1, expected_price=33.35
[2025-12-29 14:55:27.182569] ‚úì BUY ORDER EXECUTED
  Strike: 25900.0 PUT
  Expiry: 2025-12-30
  Entry Price: ‚Çπ33.35
  Size: 75
  Cost: ‚Çπ2,501.25
  VWAP: ‚Çπ31.46
  OI: 15,052,500 (Change: -421.88%)
  Remaining Cash: ‚Çπ97,498.75
[2025-12-29 14:55:00.002859+05:30] üîµ BUY OPTION EXECUTED: PUT 25900.0 @ ‚Çπ33.35 (Expiry: 2025-12-30, 1 lot = 75 qty)
[2025-12-29 14:55:00.002859+05:30]    üìä ENTRY DATA: VWAP=31.46, OI=15,052,500, OI Change=-663,000 (-4.22%)
[2025-12-29 14:55:00.002859+05:30] Forcing EOD exit for 1 position(s)
[2025-12-29 14:55:27.183327] ‚úì SELL ORDER EXECUTED
  Strike: 25900.0 PUT
  Exit Price: ‚Çπ33.35
  P&L: ‚Çπ+0.00 (+0.00%)
  Exit Reason: EOD Exit
  Cash: ‚Çπ100,000.00

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:55:27] Waiting 273s for next candle at 15:00:00
