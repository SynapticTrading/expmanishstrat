/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2025-12-29 14:41:28.211603+05:30] Checking for previous session...
[2025-12-29 14:41:28.211822+05:30] ‚úì State loaded from paper_trading/state/trading_state_20251229.json
[2025-12-29 14:41:28.211851+05:30] Previous state found but no active positions - starting fresh

[2025-12-29 14:41:28.211862+05:30] Connecting to Zerodha...
[2025-12-29 14:41:28.211874] Connecting to Zerodha...
[2025-12-29 14:41:28.386042] Generated TOTP: 393850
[2025-12-29 14:41:28.483879] ‚úì Request token extracted from redirect
[2025-12-29 14:41:28.483901] Request token obtained: xKHKWedoCpD2XPw1V0TR...
[2025-12-29 14:41:28.561233] ‚úì Connection successful!
[2025-12-29 14:41:28.561246] Access Token: zPIfOKAtDC4EEcwn92eD...
[2025-12-29 14:41:28.561265] Zerodha data feed initialized
[2025-12-29 14:41:28.561271+05:30] ‚úì Connected to Zerodha

[2025-12-29 14:41:28.561289+05:30] Initializing new session...
[2025-12-29 14:41:28.561699+05:30] Session initialized: SESSION_20251229_1441
[2025-12-29 14:41:28.561712+05:30] State file: paper_trading/state/trading_state_20251229.json
[2025-12-29 14:41:28.561731+05:30] Loading instruments...
[2025-12-29 14:41:28.561739] Loading instruments...
[2025-12-29 14:41:28.561744] Fetching instruments for NFO...
[2025-12-29 14:41:29.663701] ‚úì Retrieved 38153 instruments
[2025-12-29 14:41:29.670222] Fetching instruments for NSE...
[2025-12-29 14:41:29.781695] ‚úì Retrieved 9078 instruments
[2025-12-29 14:41:29.785515] ‚úì Nifty 50 token: 256265
[2025-12-29 14:41:29.785537] ‚úì Instruments loaded
[2025-12-29 14:41:29.785548+05:30] Initializing paper broker...
[2025-12-29 14:41:29.786092] Paper Broker initialized with capital: ‚Çπ100,000.00
[2025-12-29 14:41:29.786108] Trade log: paper_trading/logs/trades_20251229_144129.csv
[2025-12-29 14:41:29.786121+05:30] Initializing OI analyzer...
[2025-12-29 14:41:29.786475+05:30] Initializing strategy...
[2025-12-29 14:41:29.786507] Strategy initialized
  Entry: 09:30:00 - 15:29:00
  Exit: 14:50:00 - 15:00:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2025-12-29 14:41:29.786780+05:30] ‚úì All components initialized

================================================================================
[2025-12-29 14:41:29.786796+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2025-12-29 14:41:29.786943+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2025-12-29 14:41:29.786983+05:30] ‚úì Exit monitor loop started
[2025-12-29 14:41:29.787258+05:30] ‚úì Strategy loop started

================================================================================
[2025-12-29 14:41:29.787269+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:41:29.787269+05:30] Nifty Spot: 25943.00
[2025-12-29 14:41:29.830429] Fetching quotes for 22 options...
[2025-12-29 14:41:29.876167] ‚úì Retrieved 22 option quotes

================================================================================
[2025-12-29 14:41:29.787269+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2025-12-29 14:41:29.787269+05:30] Determining direction using CURRENT OI data...
[2025-12-29 14:41:29.787269+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2025-12-29 14:41:29.787269+05:30] NEW TRADING DAY: 2025-12-29
================================================================================
[2025-12-29 14:41:29.787269+05:30] Max Call OI: 34,024,225 @ 26000.0, Max Put OI: 17,003,550 @ 25900.0
[2025-12-29 14:41:29.787269+05:30] Direction determined: PUT (Call dist: 57.00, Put dist: 43.00)
[2025-12-29 14:41:29.787269+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=25900.0, Expiry=2025-12-30, Spot=25943.00
[2025-12-29 14:41:29.787269+05:30] üîÑ Reset VWAP running totals for new day: 2025-12-29
[2025-12-29 14:41:29.787269+05:30] üéØ Initialized VWAP for PUT 25900.0: 66 bars from 9:15 AM
[2025-12-29 14:41:29.787269+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 14:41:29.787269+05:30] PUT 25900.0: OI=17,003,550, Change=0 (+0.00%) - BUILDING
[2025-12-29 14:41:29.787269+05:30] PUT 25900.0: Price=‚Çπ27.20, VWAP=‚Çπ27.20 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:41:29] Waiting 210s for next candle at 14:45:00

================================================================================
[2025-12-29 14:45:00.028691+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-29 14:45:00.028691+05:30] Nifty Spot: 25936.10
[2025-12-29 14:45:00.090668] Fetching quotes for 22 options...
[2025-12-29 14:45:00.136476] ‚úì Retrieved 22 option quotes
[2025-12-29 14:45:00.028691+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-29 14:45:00.028691+05:30] PUT 25900.0: OI=16,304,325, Change=-699,225 (-4.11%) - UNWINDING ‚úì
[2025-12-29 14:45:00.028691+05:30] PUT 25900.0: Price=‚Çπ30.00, VWAP=‚Çπ28.62 - ABOVE ‚úì
[2025-12-29 14:45:00.028691+05:30] üéØ ENTRY SIGNAL: PUT 25900.0 - Price: 30.00, VWAP: 28.62, OI Change: -699,225 (-4.11%)
[2025-12-29 14:45:00.028691+05:30] üìà PLACING BUY ORDER: size=1, expected_price=30.00
[2025-12-29 14:45:00.138211] ‚úì BUY ORDER EXECUTED
  Strike: 25900.0 PUT
  Expiry: 2025-12-30
  Entry Price: ‚Çπ30.00
  Size: 75
  Cost: ‚Çπ2,250.00
  VWAP: ‚Çπ28.62
  OI: 16,304,325 (Change: -411.22%)
  Remaining Cash: ‚Çπ97,750.00
[2025-12-29 14:45:00.028691+05:30] üîµ BUY OPTION EXECUTED: PUT 25900.0 @ ‚Çπ30.00 (Expiry: 2025-12-30, 1 lot = 75 qty)
[2025-12-29 14:45:00.028691+05:30]    üìä ENTRY DATA: VWAP=28.62, OI=16,304,325, OI Change=-699,225 (-4.11%)

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-29
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 1
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:45:00] Waiting 300s for next candle at 14:50:00
[2025-12-29 14:45:29.828686+05:30] üîç Exit Monitor: Checking 1 position(s)...
[2025-12-29 14:45:29.828686+05:30] üìä LTP CHECK: 25900.0 PUT
    Current LTP: ‚Çπ30.00 | Entry: ‚Çπ30.00 | P&L: +0.00%
    Initial Stop: ‚Çπ22.50 (distance: 33.33%)
[2025-12-29 14:46:29.832508+05:30] üîç Exit Monitor: Checking 1 position(s)...
[2025-12-29 14:46:29.832508+05:30] üìä LTP CHECK: 25900.0 PUT
    Current LTP: ‚Çπ30.00 | Entry: ‚Çπ30.00 | P&L: +0.00%
    Initial Stop: ‚Çπ22.50 (distance: 33.33%)
[2025-12-29 14:47:29.839947+05:30] üîç Exit Monitor: Checking 1 position(s)...
[2025-12-29 14:47:29.839947+05:30] üìä LTP CHECK: 25900.0 PUT
    Current LTP: ‚Çπ30.00 | Entry: ‚Çπ30.00 | P&L: +0.00%
    Initial Stop: ‚Çπ22.50 (distance: 33.33%)
[2025-12-29 14:48:29.843866+05:30] üîç Exit Monitor: Checking 1 position(s)...
[2025-12-29 14:48:29.843866+05:30] üìä LTP CHECK: 25900.0 PUT
    Current LTP: ‚Çπ30.00 | Entry: ‚Çπ30.00 | P&L: +0.00%
    Initial Stop: ‚Çπ22.50 (distance: 33.33%)
[2025-12-29 14:49:29.848722+05:30] üîç Exit Monitor: Checking 1 position(s)...
[2025-12-29 14:49:29.848722+05:30] üìä LTP CHECK: 25900.0 PUT
    Current LTP: ‚Çπ30.00 | Entry: ‚Çπ30.00 | P&L: +0.00%
    Initial Stop: ‚Çπ22.50 (distance: 33.33%)
