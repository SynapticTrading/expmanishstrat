/Users/Algo_Trading/manishsir_options/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(

================================================================================
UNIVERSAL PAPER TRADING SYSTEM
================================================================================

Loading configuration...
Loading credentials from: paper_trading/config/credentials_zerodha.txt
Creating broker instance...
‚úì Broker: Zerodha

[2025-12-30 13:35:50.953630+05:30] Checking for previous session...
[2025-12-30 13:35:50.953704+05:30] No previous state found - starting fresh

[2025-12-30 13:35:50.953715+05:30] Connecting to Zerodha...
[2025-12-30 13:35:50.953725] Connecting to Zerodha...
[2025-12-30 13:35:51.227278] Generated TOTP: 019687
[2025-12-30 13:35:51.348363] ‚úì Request token extracted from redirect
[2025-12-30 13:35:51.348398] Request token obtained: 5tx7cHSSZSyd0gXV9HYM...
[2025-12-30 13:35:51.408926] ‚úì Connection successful!
[2025-12-30 13:35:51.408959] Access Token: HVGU6h8Ixfzs8ojX6qSv...
[2025-12-30 13:35:51.409016] Zerodha data feed initialized
[2025-12-30 13:35:51.409030+05:30] ‚úì Connected to Zerodha

[2025-12-30 13:35:51.409072+05:30] Initializing new session...
[2025-12-30 13:35:51.410080+05:30] Session initialized: SESSION_20251230_1335
[2025-12-30 13:35:51.410098+05:30] State file: paper_trading/state/trading_state_20251230.json
[2025-12-30 13:35:51.410131+05:30] Loading instruments...
[2025-12-30 13:35:51.410146] Loading instruments...
[2025-12-30 13:35:51.410156] Fetching instruments for NFO...
[2025-12-30 13:35:52.560638] ‚úì Retrieved 38222 instruments
[2025-12-30 13:35:52.565619] Fetching instruments for NSE...
[2025-12-30 13:35:52.687793] ‚úì Retrieved 9057 instruments
[2025-12-30 13:35:52.690307] ‚úì Nifty 50 token: 256265
[2025-12-30 13:35:52.690324] ‚úì Instruments loaded
[2025-12-30 13:35:52.690331+05:30] Initializing paper broker...
[2025-12-30 13:35:52.690821] Paper Broker initialized with capital: ‚Çπ100,000.00
[2025-12-30 13:35:52.690834] Trade log: paper_trading/logs/trades_20251230_133552.csv
[2025-12-30 13:35:52.690845+05:30] Initializing OI analyzer...
[2025-12-30 13:35:52.691152+05:30] Initializing strategy...
[2025-12-30 13:35:52.691179] Strategy initialized
  Entry: 09:30:00 - 14:30:00
  Exit: 14:50:00 - 15:00:00
  Stop Loss: 25.0%
  Trailing Stop: 10.0%
  VWAP Stop: 5.0%
  OI Stop: 10.0%
[2025-12-30 13:35:52.691471+05:30] ‚úì All components initialized

================================================================================
[2025-12-30 13:35:52.691487+05:30] Starting DUAL-LOOP paper trading...
  Broker: Zerodha
  Loop 1: Strategy Loop - Every 5 minutes (Entry decisions)
  Loop 2: Exit Monitor Loop - Every 1 minute (LTP-based exits)
================================================================================

[2025-12-30 13:35:52.691605+05:30] ‚úì Exit monitor loop started (1-min LTP)
[2025-12-30 13:35:52.691632+05:30] ‚úì Exit monitor loop started
[2025-12-30 13:35:52.691910+05:30] ‚úì Strategy loop started

================================================================================
[2025-12-30 13:35:52.691922+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 13:35:52.691922+05:30] Nifty Spot: 25915.25
[2025-12-30 13:35:52.744754] Fetching quotes for 22 options...
[2025-12-30 13:35:52.780435] ‚úì Retrieved 22 option quotes

================================================================================
[2025-12-30 13:35:52.691922+05:30] ‚ö†Ô∏è  STARTED LATE (after 9:15 AM)
[2025-12-30 13:35:52.691922+05:30] Determining direction using CURRENT OI data...
[2025-12-30 13:35:52.691922+05:30] (OI buildup direction is still valid mid-day)
================================================================================


================================================================================
[2025-12-30 13:35:52.691922+05:30] NEW TRADING DAY: 2025-12-30
================================================================================
[2025-12-30 13:35:52.691922+05:30] Max Call OI: 38,855,300 @ 26000.0, Max Put OI: 37,587,225 @ 25900.0
[2025-12-30 13:35:52.691922+05:30] Direction determined: PUT (Call dist: 84.75, Put dist: 15.25)
[2025-12-30 13:35:52.691922+05:30] ‚úì Daily Analysis Complete: Direction=PUT, Strike=25900.0, Expiry=2025-12-30, Spot=25915.25
[2025-12-30 13:35:52.691922+05:30] üîÑ Reset VWAP running totals for new day: 2025-12-30
[2025-12-30 13:35:52.691922+05:30] üéØ Initialized VWAP for PUT 25900.0: 53 bars from 9:15 AM
[2025-12-30 13:35:52.691922+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 13:35:52.691922+05:30] PUT 25900.0: OI=37,587,225, Change=0 (+0.00%) - BUILDING
[2025-12-30 13:35:52.691922+05:30] PUT 25900.0: Price=‚Çπ12.90, VWAP=‚Çπ12.90 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[13:35:52] Waiting 247s for next candle at 13:40:00

================================================================================
[2025-12-30 13:40:00.005443+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 13:40:30.012557] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-30 13:40:30.012615] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 13:40:00.005443+05:30] Nifty Spot: 25919.65
[2025-12-30 13:40:31.090890] Fetching quotes for 22 options...
[2025-12-30 13:40:31.127917] ‚úì Retrieved 22 option quotes
[2025-12-30 13:40:00.005443+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 13:40:00.005443+05:30] PUT 25900.0: OI=40,659,450, Change=3,072,225 (+8.17%) - BUILDING
[2025-12-30 13:40:00.005443+05:30] PUT 25900.0: Price=‚Çπ11.40, VWAP=‚Çπ12.14 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[13:40:31] Waiting 269s for next candle at 13:45:00

================================================================================
[2025-12-30 13:45:00.005456+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 13:45:27.632375] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 13:45:27.632449] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 13:45:00.005456+05:30] Nifty Spot: 25937.85
[2025-12-30 13:45:28.714428] Fetching quotes for 22 options...
[2025-12-30 13:45:28.754375] ‚úì Retrieved 22 option quotes
[2025-12-30 13:45:00.005456+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 13:45:00.005456+05:30] PUT 25900.0: OI=43,019,625, Change=5,432,400 (+14.45%) - BUILDING
[2025-12-30 13:45:00.005456+05:30] PUT 25900.0: Price=‚Çπ7.00, VWAP=‚Çπ10.36 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[13:45:28] Waiting 271s for next candle at 13:50:00

================================================================================
[2025-12-30 13:50:00.005462+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 13:50:26.633721] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 13:50:26.633795] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 13:50:00.005462+05:30] Nifty Spot: 25952.95
[2025-12-30 13:50:27.725117] Fetching quotes for 22 options...
[2025-12-30 13:50:27.763416] ‚úì Retrieved 22 option quotes
[2025-12-30 13:50:00.005462+05:30] üìç STRIKE UPDATED: 25900.0 ‚Üí 25950.0 (Spot: 25952.95)
[2025-12-30 13:50:00.005462+05:30] üéØ Initialized VWAP for PUT 25950.0: 56 bars from 9:15 AM
[2025-12-30 13:50:00.005462+05:30] Checking entry: PUT 25950.0, Expiry=2025-12-30
[2025-12-30 13:50:00.005462+05:30] PUT 25950.0: OI=20,020,050, Change=0 (+0.00%) - BUILDING
[2025-12-30 13:50:00.005462+05:30] PUT 25950.0: Price=‚Çπ20.35, VWAP=‚Çπ20.35 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25950.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[13:50:27] Waiting 272s for next candle at 13:55:00

================================================================================
[2025-12-30 13:55:00.022058+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 13:55:29.222571] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 13:55:29.222642] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 13:55:00.022058+05:30] Nifty Spot: 25942.55
[2025-12-30 13:55:30.313820] Fetching quotes for 22 options...
[2025-12-30 13:55:30.353001] ‚úì Retrieved 22 option quotes
[2025-12-30 13:55:00.022058+05:30] üìç STRIKE UPDATED: 25950.0 ‚Üí 25900.0 (Spot: 25942.55)
[2025-12-30 13:55:00.022058+05:30] üéØ Initialized VWAP for PUT 25900.0: 57 bars from 9:15 AM
[2025-12-30 13:55:00.022058+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 13:55:00.022058+05:30] PUT 25900.0: OI=47,795,175, Change=0 (+0.00%) - BUILDING
[2025-12-30 13:55:00.022058+05:30] PUT 25900.0: Price=‚Çπ6.45, VWAP=‚Çπ9.31 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[13:55:30] Waiting 270s for next candle at 14:00:00

================================================================================
[2025-12-30 14:00:00.006272+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:00:24.515799] ‚ö†Ô∏è  Error getting LTP: ('Connection aborted.', TimeoutError(60, 'Operation timed out'))
[2025-12-30 14:00:24.515838] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 14:00:00.006272+05:30] Nifty Spot: 25944.65
[2025-12-30 14:00:25.593188] Fetching quotes for 22 options...
[2025-12-30 14:00:25.633274] ‚úì Retrieved 22 option quotes
[2025-12-30 14:00:00.006272+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 14:00:00.006272+05:30] PUT 25900.0: OI=49,931,025, Change=2,135,850 (+4.47%) - BUILDING
[2025-12-30 14:00:00.006272+05:30] PUT 25900.0: Price=‚Çπ6.10, VWAP=‚Çπ8.61 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:00:25] Waiting 274s for next candle at 14:05:00

================================================================================
[2025-12-30 14:05:00.006319+05:30] STRATEGY LOOP - Processing 5-min candle...
================================================================================

[2025-12-30 14:05:30.030005] ‚ö†Ô∏è  Error getting LTP: HTTPSConnectionPool(host='api.kite.trade', port=443): Read timed out. (read timeout=30)
[2025-12-30 14:05:30.030052] ‚ö†Ô∏è  Retrying in 1s... (attempt 1/3)
[2025-12-30 14:05:00.006319+05:30] Nifty Spot: 25941.95
[2025-12-30 14:05:31.384937] Fetching quotes for 22 options...
[2025-12-30 14:05:31.438636] ‚úì Retrieved 22 option quotes
[2025-12-30 14:05:00.006319+05:30] Checking entry: PUT 25900.0, Expiry=2025-12-30
[2025-12-30 14:05:00.006319+05:30] PUT 25900.0: OI=50,496,825, Change=2,701,650 (+5.65%) - BUILDING
[2025-12-30 14:05:00.006319+05:30] PUT 25900.0: Price=‚Çπ5.15, VWAP=‚Çπ7.98 - BELOW ‚úó

--------------------------------------------------------------------------------
STATUS UPDATE
--------------------------------------------------------------------------------
Date: 2025-12-30
Broker: Zerodha
Daily Direction: PUT @ 25900.0
Open Positions: 0
Total P&L: ‚Çπ0.00
ROI: +0.00%
--------------------------------------------------------------------------------

[14:05:31] Waiting 269s for next candle at 14:10:00
